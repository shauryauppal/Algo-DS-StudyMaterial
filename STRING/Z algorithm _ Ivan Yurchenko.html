<!DOCTYPE html>
<!-- saved from url=(0046)https://ivanyu.me/blog/2013/10/15/z-algorithm/ -->
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Z algorithm _ Ivan Yurchenko_files/saved_resource"></script><script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/shares.json"></script><script src="./Z algorithm _ Ivan Yurchenko_files/cb=gapi.loaded_1" async=""></script><script src="./Z algorithm _ Ivan Yurchenko_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/plusone.js.download" gapi_processed="true"></script><script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/widgets.js.download"></script><script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/shares(1).json"></script><script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/saved_resource(1)"></script><script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/300lo.json"></script><script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/_ate.track.config_resp"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Z algorithm | Ivan Yurchenko</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://ivanyu.me/xmlrpc.php">

<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Ivan Yurchenko » Feed" href="https://ivanyu.me/feed/">
<link rel="alternate" type="application/rss+xml" title="Ivan Yurchenko » Comments Feed" href="https://ivanyu.me/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Ivan Yurchenko » Z algorithm Comments Feed" href="https://ivanyu.me/blog/2013/10/15/z-algorithm/feed/">
		<script type="text/javascript" async="" src="./Z algorithm _ Ivan Yurchenko_files/watch.js.download"></script><script type="text/javascript" async="" src="./Z algorithm _ Ivan Yurchenko_files/ga.js.download"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/ivanyu.me\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Z algorithm _ Ivan Yurchenko_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./Z algorithm _ Ivan Yurchenko_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./Z algorithm _ Ivan Yurchenko_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Z algorithm _ Ivan Yurchenko_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="kirumo-style-css" href="./Z algorithm _ Ivan Yurchenko_files/style.css" type="text/css" media="all">
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/jquery.js.download"></script>
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/jquery-migrate.min.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/ivanyu.me\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/crayon.min.js.download"></script>
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/external-tracking.min.js.download"></script>
<link rel="https://api.w.org/" href="https://ivanyu.me/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://ivanyu.me/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://ivanyu.me/wp-includes/wlwmanifest.xml"> 
<link rel="next" title="Finding a cycle in a linked list" href="https://ivanyu.me/blog/2013/11/24/finding-a-cycle-in-a-linked-list/">
<meta name="generator" content="WordPress 4.7">
<link rel="canonical" href="https://ivanyu.me/blog/2013/10/15/z-algorithm/">
<link rel="shortlink" href="https://ivanyu.me/?p=5">
<link rel="alternate" type="application/json+oembed" href="https://ivanyu.me/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fivanyu.me%2Fblog%2F2013%2F10%2F15%2Fz-algorithm%2F">
<link rel="alternate" type="text/xml+oembed" href="https://ivanyu.me/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fivanyu.me%2Fblog%2F2013%2F10%2F15%2Fz-algorithm%2F&amp;format=xml">

<style type="text/css" media="screen">

	table.ztable {
  cellspacing: 0px;
  cellpadding: 0px;
  border-collapse: collapse;
  border: 0px solid black;
  text-align: center;
  line-height: normal;
  table-layout: fixed;
  width:  1px;
  margin-bottom: 5px;

  font-family: Consolas,Menlo,Monaco,'Andale Mono','lucida console','Courier New',monospace !important;
}

table.ztable-pointers {
  border: 1px dotted black;
}

table.ztable tr:nth-of-type(even) {
	background: #ffffff;
}

td.ztable {
  text-align: center;
  border: 1px solid black;
  margin: 2pt 10pt;
  width: 1.9em;
  font-size: 87%;
  padding-bottom: 0.1em;
  padding-left: 0.1em;
  padding-right: 0.1em;
  padding-top: 0.1em;
}

td.ztable-rowhead {
  text-align: left;
  padding: 2pt;
  width: 5.8em;
}

td.ztable-zbox {
  background-color: #c6d9f1;
}

td.ztable-mis {
  background-color: #FF5B61;
}

td.ztable-match {
  background-color: #9FFF72;
}

td.ztable-pointer {
  font-family: monospace;
  border: 0px solid black;
  padding-bottom: 0px;
  padding-top: 0px;
}


</style>

		<style type="text/css">
					a,
			a:active,
			a:hover,
			a:visited,
			a:visited:hover,
			.site-title a:hover,
			.main-navigation a:hover,
			.footer-wrap a:hover {
				color: 0074a2;
			}
			.comment-list .comment-reply-link:hover,
			a.button,
			a.button:hover,
			button:hover,
			input[type="submit"]:hover {
				background: 0074a2;
			}
				</style>
		
		<style type="text/css">
					#mobile-menu,
			.mobile-header,
			#masthead,
			.footer-wrap,
			#nav-toggle, button,
			a.button,
			input[type="button"],
			input[type="reset"],
			input[type="submit"] {
				background: 333333;;
			}
				</style>
				<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<!-- Google Analytics Tracking by Google Analyticator 6.5.0: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">
    var analyticsFileTypes = [''];
    var analyticsSnippet = 'enabled';
    var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
  
	_gaq.push(['_setAccount', 'UA-45008342-1']);
    _gaq.push(['_addDevId', 'i9k95']); // Google Analyticator App ID with Google
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
<script type="text/javascript" async="" src="./Z algorithm _ Ivan Yurchenko_files/embed.js.download"></script><script async="" type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/count.js.download"></script><script src="./Z algorithm _ Ivan Yurchenko_files/count-data.js.download"></script><style type="text/css">.at-icon{fill:#fff;border:0}.at-icon-wrapper{display:inline-block;overflow:hidden}a .at-icon-wrapper{cursor:pointer}.at-rounded,.at-rounded-element .at-icon-wrapper{border-radius:12%}.at-circular,.at-circular-element .at-icon-wrapper{border-radius:50%}.addthis_32x32_style .at-icon{width:2pc;height:2pc}.addthis_24x24_style .at-icon{width:24px;height:24px}.addthis_20x20_style .at-icon{width:20px;height:20px}.addthis_16x16_style .at-icon{width:1pc;height:1pc}#at16lb{display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:1001;background-color:#000;opacity:.001}#at_complete,#at_error,#at_share,#at_success{position:static!important}.at15dn{display:none}#at15s,#at16p,#at16p form input,#at16p label,#at16p textarea,#at_share .at_item{font-family:arial,helvetica,tahoma,verdana,sans-serif!important;font-size:9pt!important;outline-style:none;outline-width:0;line-height:1em}* html #at15s.mmborder{position:absolute!important}#at15s.mmborder{position:fixed!important;width:250px!important}#at15s{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);float:none;line-height:1em;margin:0;overflow:visible;padding:5px;text-align:left;position:absolute}#at15s a,#at15s span{outline:0;direction:ltr;text-transform:none}#at15s .at-label{margin-left:5px}#at15s .at-icon-wrapper{width:1pc;height:1pc;vertical-align:middle}#at15s .at-icon{width:1pc;height:1pc}.at4-icon{display:inline-block;background-repeat:no-repeat;background-position:top left;margin:0;overflow:hidden;cursor:pointer}.addthis_16x16_style .at4-icon,.addthis_default_style .at4-icon,.at4-icon,.at-16x16{width:1pc;height:1pc;line-height:1pc;background-size:1pc!important}.addthis_32x32_style .at4-icon,.at-32x32{width:2pc;height:2pc;line-height:2pc;background-size:2pc!important}.addthis_24x24_style .at4-icon,.at-24x24{width:24px;height:24px;line-height:24px;background-size:24px!important}.addthis_20x20_style .at4-icon,.at-20x20{width:20px;height:20px;line-height:20px;background-size:20px!important}.at4-icon.circular,.circular .at4-icon,.circular.aticon{border-radius:50%}.at4-icon.rounded,.rounded .at4-icon{border-radius:4px}.at4-icon-left{float:left}#at15s .at4-icon{text-indent:20px;padding:0;overflow:visible;white-space:nowrap;background-size:1pc;width:1pc;height:1pc;background-position:top left;display:inline-block;line-height:1pc}.addthis_vertical_style .at4-icon,.at4-follow-container .at4-icon{margin-right:5px}html>body #at15s{width:250px!important}#at15s.atm{background:none!important;padding:0!important;width:10pc!important}#at15s_inner{background:#fff;border:1px solid #fff;margin:0}#at15s_head{position:relative;background:#f2f2f2;padding:4px;cursor:default;border-bottom:1px solid #e5e5e5}.at15s_head_success{background:#cafd99!important;border-bottom:1px solid #a9d582!important}.at15s_head_success a,.at15s_head_success span{color:#000!important;text-decoration:none}#at15s_brand,#at15sptx,#at16_brand{position:absolute}#at15s_brand{top:4px;right:4px}.at15s_brandx{right:20px!important}a#at15sptx{top:4px;right:4px;text-decoration:none;color:#4c4c4c;font-weight:700}#at15sptx:hover{text-decoration:underline}#at16_brand{top:5px;right:30px;cursor:default}#at_hover{padding:4px}#at_hover .at_item,#at_share .at_item{background:#fff!important;float:left!important;color:#4c4c4c!important}#at_share .at_item .at-icon-wrapper{margin-right:5px}#at_hover .at_bold{font-weight:700;color:#000!important}#at_hover .at_item{width:7pc!important;padding:2px 3px!important;margin:1px;text-decoration:none!important}#at_hover .at_item.athov,#at_hover .at_item:focus,#at_hover .at_item:hover{margin:0!important}#at_hover .at_item.athov,#at_hover .at_item:focus,#at_hover .at_item:hover,#at_share .at_item.athov,#at_share .at_item:hover{background:#f2f2f2!important;border:1px solid #e5e5e5;color:#000!important;text-decoration:none}.ipad #at_hover .at_item:focus{background:#fff!important;border:1px solid #fff}.at15t{display:block!important;height:1pc!important;line-height:1pc!important;padding-left:20px!important;background-position:0 0;text-align:left}.addthis_button,.at15t{cursor:pointer}.addthis_toolbox a.at300b,.addthis_toolbox a.at300m{width:auto}.addthis_toolbox a{margin-bottom:5px;line-height:initial}.addthis_toolbox.addthis_vertical_style{width:200px}.addthis_button_facebook_like .fb_iframe_widget{line-height:100%}.addthis_button_facebook_like iframe.fb_iframe_widget_lift{max-width:none}.addthis_toolbox a.addthis_button_counter,.addthis_toolbox a.addthis_button_facebook_like,.addthis_toolbox a.addthis_button_facebook_send,.addthis_toolbox a.addthis_button_facebook_share,.addthis_toolbox a.addthis_button_foursquare,.addthis_toolbox a.addthis_button_google_plusone,.addthis_toolbox a.addthis_button_linkedin_counter,.addthis_toolbox a.addthis_button_pinterest_pinit,.addthis_toolbox a.addthis_button_stumbleupon_badge,.addthis_toolbox a.addthis_button_tweet{display:inline-block}.at-share-tbx-element .google_plusone_iframe_widget>span>div{vertical-align:top!important}.addthis_toolbox span.addthis_follow_label{display:none}.addthis_toolbox.addthis_vertical_style span.addthis_follow_label{display:block;white-space:nowrap}.addthis_toolbox.addthis_vertical_style a{display:block}.addthis_toolbox.addthis_vertical_style.addthis_32x32_style a{line-height:2pc;height:2pc}.addthis_toolbox.addthis_vertical_style .at300bs{margin-right:4px;float:left}.addthis_toolbox.addthis_20x20_style span{line-height:20px}.addthis_toolbox.addthis_32x32_style span{line-height:2pc}.addthis_toolbox.addthis_pill_combo_style .addthis_button_compact .at15t_compact,.addthis_toolbox.addthis_pill_combo_style a{float:left}.addthis_toolbox.addthis_pill_combo_style a.addthis_button_tweet{margin-top:-2px}.addthis_toolbox.addthis_pill_combo_style .addthis_button_compact .at15t_compact{margin-right:4px}.addthis_default_style .addthis_separator{margin:0 5px;display:inline}div.atclear{clear:both}.addthis_default_style .addthis_separator,.addthis_default_style .at4-icon,.addthis_default_style .at300b,.addthis_default_style .at300bo,.addthis_default_style .at300bs,.addthis_default_style .at300m{float:left}.at300b img,.at300bo img{border:0}a.at300b .at4-icon,a.at300m .at4-icon{display:block}.addthis_default_style .at300b,.addthis_default_style .at300bo,.addthis_default_style .at300m{padding:0 2px}.at300b,.at300bo,.at300bs,.at300m{cursor:pointer}.addthis_button_facebook_like.at300b:hover,.addthis_button_facebook_like.at300bs:hover,.addthis_button_facebook_send.at300b:hover,.addthis_button_facebook_send.at300bs:hover{opacity:1}.addthis_20x20_style .at15t,.addthis_20x20_style .at300bs{overflow:hidden;display:block;height:20px!important;width:20px!important;line-height:20px!important}.addthis_32x32_style .at15t,.addthis_32x32_style .at300bs{overflow:hidden;display:block;height:2pc!important;width:2pc!important;line-height:2pc!important}.at300bs{overflow:hidden;display:block;background-position:0 0;height:1pc;width:1pc;line-height:1pc!important}.addthis_default_style .at15t_compact,.addthis_default_style .at15t_expanded{margin-right:4px}#at_share .at_item{width:123px!important;padding:4px;margin-right:2px;border:1px solid #fff}#at16p{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);z-index:10000001;position:absolute;top:50%;left:50%;width:300px;padding:10px;margin:0 auto;margin-top:-185px;margin-left:-155px;font-family:arial,helvetica,tahoma,verdana,sans-serif;font-size:9pt;color:#5e5e5e}#at_share{margin:0;padding:0}#at16pt{position:relative;background:#f2f2f2;height:13px;padding:5px 10px}#at16pt a,#at16pt h4{font-weight:700}#at16pt h4{display:inline;margin:0;padding:0;font-size:9pt;color:#4c4c4c;cursor:default}#at16pt a{position:absolute;top:5px;right:10px;color:#4c4c4c;text-decoration:none;padding:2px}#at15sptx:focus,#at16pt a:focus{outline:thin dotted}#at15s #at16pf a{top:1px}#_atssh{width:1px!important;height:1px!important;border:0!important}.atm{width:10pc!important;padding:0;margin:0;line-height:9pt;letter-spacing:normal;font-family:arial,helvetica,tahoma,verdana,sans-serif;font-size:9pt;color:#444;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgaGAgAjAxEAlGFVJHIUCAAQDcngCUgqGMqwAAAABJRU5ErkJggg==);padding:4px}.atm-f{text-align:right;border-top:1px solid #ddd;padding:5px 8px}.atm-i{background:#fff;border:1px solid #d5d6d6;padding:0;margin:0;box-shadow:1px 1px 5px rgba(0,0,0,.15)}.atm-s{margin:0!important;padding:0!important}.atm-s a:focus{border:transparent;outline:0;-webkit-transition:none;transition:none}#at_hover.atm-s a,.atm-s a{display:block;text-decoration:none;padding:4px 10px;color:#235dab!important;font-weight:400;font-style:normal;-webkit-transition:none;transition:none}#at_hover.atm-s .at_bold{color:#235dab!important}#at_hover.atm-s a:hover,.atm-s a:hover{background:#2095f0;text-decoration:none;color:#fff!important}#at_hover.atm-s .at_bold{font-weight:700}#at_hover.atm-s a:hover .at_bold{color:#fff!important}.atm-s a .at-label{vertical-align:middle;margin-left:5px;direction:ltr}.at_PinItButton{display:block;width:40px;height:20px;padding:0;margin:0;background-image:url(//s7.addthis.com/static/t00/pinit00.png);background-repeat:no-repeat}.at_PinItButton:hover{background-position:0 -20px}.addthis_toolbox .addthis_button_pinterest_pinit{position:relative}.at-share-tbx-element .fb_iframe_widget span{vertical-align:baseline!important}#at16pf{height:auto;text-align:right;padding:4px 8px}.at-privacy-info{position:absolute;left:7px;bottom:7px;cursor:pointer;text-decoration:none;font-family:helvetica,arial,sans-serif;font-size:10px;line-height:9pt;letter-spacing:.2px;color:#666}.at-privacy-info:hover{color:#000}.body .wsb-social-share .wsb-social-share-button-vert{padding-top:0;padding-bottom:0}.body .wsb-social-share.addthis_counter_style .addthis_button_tweet.wsb-social-share-button{padding-top:44px}.body .wsb-social-share.addthis_counter_style .addthis_button_google_plusone.wsb-social-share-button{padding-top:4px}@media print{#at4-follow,#at4-share,#at4-thankyou,#at4-whatsnext,#at4m-mobile,#at15s,.at4,.at4-recommended{display:none!important}}@media screen and (max-width:400px){.at4win{width:100%}}@media screen and (max-height:700px) and (max-width:400px){.at4-thankyou-inner .at4-recommended-container{height:122px;overflow:hidden}.at4-thankyou-inner .at4-recommended .at4-recommended-item:first-child{border-bottom:1px solid #c5c5c5}}</style><style type="text/css">.at-branding-logo{font-family:helvetica,arial,sans-serif;text-decoration:none;font-size:10px;display:inline-block;margin:2px 0;letter-spacing:.2px}.at-branding-logo .at-branding-icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////+GlNUkcc1QAAAB1JREFUeNpiYIQDBjQmAwMmkwEM0JnY1WIxFyDAABGeAFEudiZsAAAAAElFTkSuQmCC")}.at-branding-logo .at-branding-icon,.at-branding-logo .at-privacy-icon{display:inline-block;height:10px;width:10px;margin-left:4px;margin-right:3px;margin-bottom:-1px;background-repeat:no-repeat}.at-branding-logo .at-privacy-icon{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAKCAMAAABR24SMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRF8fr9ot/xXcfn2/P5AKva////////AKTWodjhjAAAAAd0Uk5T////////ABpLA0YAAAA6SURBVHjaJMzBDQAwCAJAQaj7b9xifV0kUKJ9ciWxlzWEWI5gMF65KUTv0VKkjVeTerqE/x7+9BVgAEXbAWI8QDcfAAAAAElFTkSuQmCC")}.at-branding-logo span{text-decoration:none}.at-branding-logo .at-branding-addthis,.at-branding-logo .at-branding-powered-by{color:#666}.at-branding-logo .at-branding-addthis:hover{color:#333}.at-cv-with-image .at-branding-addthis,.at-cv-with-image .at-branding-addthis:hover{color:#fff}a.at-branding-logo:visited{color:initial}.at-branding-info{display:inline-block;padding:0 5px;color:#666;border:1px solid #666;border-radius:50%;font-size:10px;line-height:9pt;opacity:.7;transition:all .3s ease;text-decoration:none}.at-branding-info span{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.at-branding-info:before{content:'i';font-family:Times New Roman}.at-branding-info:hover{color:#0780df;border-color:#0780df}</style><script type="text/javascript" charset="utf-8" async="" src="./Z algorithm _ Ivan Yurchenko_files/layers.136713430e8d2517734e.js.download"></script><style type="text/css">.at-share-dock.atss{top:auto;left:0;right:0;bottom:0;width:100%;max-width:100%;z-index:1000200;box-shadow:0 0 1px 1px #e2dfe2}.at-share-dock.at-share-dock-zindex-hide{z-index:-1!important}.at-share-dock.atss-top{bottom:auto;top:0}.at-share-dock a{width:auto;-webkit-transition:none;transition:none;color:#fff;text-decoration:none;box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.at-share-dock a:hover{width:auto}.at-share-dock .at4-count{height:43px;padding:5px 0 0;line-height:20px;background:#fff;font-family:Helvetica neue,arial}.at-share-dock .at4-count span{width:100%}.at-share-dock .at4-count .at4-share-label{color:#848484;font-size:10px;letter-spacing:1px}.at-share-dock .at4-count .at4-counter{top:2px;position:relative;display:block;color:#222;font-size:22px}.at-share-dock.at-shfs-medium .at4-count{height:36px;line-height:1pc;padding-top:4px}.at-share-dock.at-shfs-medium .at4-count .at4-counter{font-size:18px}.at-share-dock.at-shfs-medium .at-share-btn .at-icon-wrapper,.at-share-dock.at-shfs-medium a .at-icon-wrapper{padding:6px 0}.at-share-dock.at-shfs-small .at4-count{height:26px;line-height:1;padding-top:3px}.at-share-dock.at-shfs-small .at4-count .at4-share-label{font-size:8px}.at-share-dock.at-shfs-small .at4-count .at4-counter{font-size:14px}.at-share-dock.at-shfs-small .at-share-btn .at-icon-wrapper,.at-share-dock.at-shfs-small a .at-icon-wrapper{padding:4px 0}</style><style type="text/css">#at4m-mobile-container{z-index:9999999;position:fixed}#at4m-menu{-webkit-transition-timing-function:linear;transition-timing-function:linear}#at4-searchClear{cursor:pointer}#at4m-dock{position:fixed;left:0;width:100%;-o-box-shadow:0 -1px 4px rgba(0,0,0,.15);box-shadow:0 -1px 4px rgba(0,0,0,.15);font-family:helvetica neue,helvetica,arial,sans-serif;font-size:14px;font-weight:300;color:#000}.at4m-dock{background:#ebebeb}.at4m-dock-bottom{top:auto;bottom:0}.at4m-dock-top{top:0;bottom:auto}.at4m-dock a:link,.at4m-dock a:visited{display:block;border:none;margin:0;padding:0;height:45px;line-height:45px;text-align:center;text-decoration:none;text-shadow:none;font-weight:700;color:#555;cursor:pointer;float:left;zoom:1}.at4m-dock a:active,.at4m-dock a:hover,.at4m-dock-toggle a:hover{background-color:#e2e2e2;color:#000;cursor:pointer}.at4m-dock a i{display:inline-block;height:45px;line-height:45px;vertical-align:middle;opacity:.2}.at4m-dock a:active i,.at4m-dock a:hover i{opacity:.9}.at4m-dock a i.at4m-dock-share{background:url(//s7.addthis.com/static/0cdf7a36b49e9150e4ddd7ce01143fdc.png) no-repeat 0 0;background-image:url(//s7.addthis.com/static/c4ee1ef2025cac1d2377de864e802791.svg),none;background-position:0 -2px;width:30px}.at4m-dock a i.at4m-dock-follow{background:url(//s7.addthis.com/static/34c65ab171688e81111b0c5219405376.png) no-repeat 0 0;background-image:url(//s7.addthis.com/static/2f9e800dffd36b9ae492670a4340386e.svg),none;background-position:0 -2px;width:26px}.at4m-dock.at4-ma1 a{display:inline-block;width:86%}.at4m-dock.at4-ma2 a{display:inline-block;width:43%}.at4m-dock.at4-ma2 a:first-child{border-right:1px solid #ccc}.at4m-dock-toggle{position:fixed;left:auto;right:0;width:14%;min-width:40px;height:45px}.at4m-dock-toggle-bottom{top:auto;bottom:0}.at4m-dock-toggle-top{bottom:auto;top:0}.at4m-dock-toggle a{display:block;background:url(//s7.addthis.com/static/6f026d41cd1a08a0f124517f4a4b6381.png) no-repeat center;background-image:url(//s7.addthis.com/static/6ac59ac63a78f7c0ecfe9bbc05ee16af.svg),none;border-left:1px solid #ccc;height:44px;line-height:44px;overflow:hidden;text-indent:-9999em;text-align:center;padding:0;margin:0;opacity:.35}.at4m-dock-toggle a.at4-dock-toggle-active{background:url(//s7.addthis.com/static/edb81de4c71c0bc5e7093002607fb828.png) no-repeat center;background-image:url(//s7.addthis.com/static/958b6ad449d91a582198eaaa1013e4a8.svg),none;background-color:#fff;border-top:1px solid #ccc}.at4m-dock-toggle.ats-dark,.at4m-dock.ats-dark{background:#262b30;border-color:#1b1b1b;color:#fff}.at4m-dock.ats-dark a{color:#f2f2f2}.at4m-dock.ats-dark a i{opacity:.25}.at4m-dock.at4-ma2.ats-dark a:first-child{border-right:1px solid #3e4247}.at4m-dock-toggle.ats-dark a:active,.at4m-dock-toggle.ats-dark a:hover,.at4m-dock.ats-dark a:active,.at4m-dock.ats-dark a:hover{background-color:#1b1e22}.at4m-dock.ats-dark a i.at4m-dock-share{background:url(//s7.addthis.com/static/969412d543656390654b7a1fbad5c052.png) no-repeat left center;background-image:url(//s7.addthis.com/static/d0b50381e6dff723034c9fb045fa5579.svg),none;background-position:0 -2px}.at4m-dock.ats-dark a i.at4m-dock-follow{background:url(//s7.addthis.com/static/031cd90bcb2cf1bc5d0514d6df32e08b.png) no-repeat left center;background-image:url(//s7.addthis.com/static/9b6c210d20bea1e6b56e800331c32bff.svg),none;background-position:0 -2px}.at4m-dock-toggle.ats-dark a{background:url(//s7.addthis.com/static/bd94d63e97308ccebb29a220dcc82c2c.png) no-repeat center;background-image:url(//s7.addthis.com/static/066d11a3dfa049803336eba1abb50292.svg),none;border-color:#676d73}.at4m-dock-toggle.ats-dark a.at4-dock-toggle-active{background:url(//s7.addthis.com/static/6ff05a92b143930d8fcc6a7d47a6859b.png) no-repeat center;background-image:url(//s7.addthis.com/static/fd9202254cfad377dad0ecc0eb38d503.svg),none}.at4m-dock-toggle.top,.at4m-dock.top{top:0;bottom:auto}.at4m-dock-toggle.top a{background:url(//s7.addthis.com/static/edb81de4c71c0bc5e7093002607fb828.png) no-repeat center;background-image:url(//s7.addthis.com/static/958b6ad449d91a582198eaaa1013e4a8.svg),none}.at4m-dock-toggle.top a.at4-dock-toggle-active{background:url(//s7.addthis.com/static/6f026d41cd1a08a0f124517f4a4b6381.png) no-repeat center;background-image:url(//s7.addthis.com/static/6ac59ac63a78f7c0ecfe9bbc05ee16af.svg),none}.at4m-dock-toggle.top.ats-dark a{background:url(//s7.addthis.com/static/6ff05a92b143930d8fcc6a7d47a6859b.png) no-repeat center;background-image:url(//s7.addthis.com/static/fd9202254cfad377dad0ecc0eb38d503.svg),none;border-color:#676d73}.at4m-dock-toggle.top.ats-dark a.at4-dock-toggle-active{background:url(//s7.addthis.com/static/bd94d63e97308ccebb29a220dcc82c2c.png) no-repeat center;background-image:url(//s7.addthis.com/static/066d11a3dfa049803336eba1abb50292.svg),none}.at4m-dock.ats-gray{border-top:1px solid #dbdbdb}.at4m-dock.ats-gray a:first-child{border-right:1px solid #dadada}.at4m-dock.ats-gray a{color:#444}.at4m-dock.ats-gray a i{opacity:.25}.at4m-dock-toggle.ats-gray a{border-color:#b2b2b2}.at4m-dock-toggle.ats-gray a.at4-dock-toggle-active{background-color:#e2e2e2;border-color:#b2b2b2}.at4m-dock-toggle.ats-light a:active,.at4m-dock-toggle.ats-light a:hover,.at4m-dock.ats-light a:active,.at4m-dock.ats-light a:hover{background-color:#f5f5f5}.at4m-dock-toggle.ats-light a.at4-dock-toggle,.at4m-dock-toggle.ats-light a.at4-dock-toggle-active{background-color:#fff;border-color:#dadada}.at4m-menu{position:fixed;background:#fff;top:0;left:0;right:0;bottom:0;font-family:helvetica neue,helvetica,arial,sans-serif;font-size:14px;font-weight:300;display:none;opacity:0}.at4m-menu.abs{position:absolute}.at4m-menu .at4m-menu-inner{position:relative;width:100%;height:100%;overflow:auto}.at4m-menu .at4m-menu-inner .at4m-menu-header{position:fixed;top:0;left:0;right:0;width:100%;background:#fff;-o-box-shadow:0 2px 4px rgba(0,0,0,.1);box-shadow:0 2px 4px rgba(0,0,0,.1);font-family:helvetica neue,helvetica,arial,sans-serif;font-weight:700;color:#444;cursor:default}.at4m-menu .at4m-menu-inner .at4m-menu-header .at4m-menu-header-inner{position:relative;height:44px;text-align:left;line-height:44px;padding:0 44px 0 15px}.at4m-menu .at4m-menu-inner .at4m-menu-header .at4m-menu-header-inner a.at4m-menu-cancel{position:absolute;top:0;right:0;display:block;background:url(//s7.addthis.com/static/56b9cf44789a75f4822ae4677c0809f0.png) no-repeat center center;background-image:url(//s7.addthis.com/static/fc0122e3c71ae79db7be2a7ccfcd419c.svg),none;width:42px;height:44px;overflow:hidden;text-indent:-9999em;opacity:.74}#at4m-menu-body{top:45px;bottom:35px;left:0;overflow-y:scroll}#at4m-menu-body,#at4m-scroller{position:absolute;width:100%}.at4m-hidden-overflow{overflow:hidden}.at4m-scroll-overflow{overflow-y:auto!important}.at4m-menu .at4m-menu-inner .at4m-menu-search{position:relative;background:#f5f5f5;border-bottom:1px solid #e7e9ec;height:44px}.at4m-menu .at4m-menu-inner .at4m-menu-search input[type=text]{position:absolute;top:7px;left:13px;right:15px;width:auto;background:transparent;border:none;height:24px;line-height:1.14em;padding:4px 4px 4px 22px;font-size:1.14em;font-weight:300;outline:0;margin-bottom:0}.at4m-menu .at4m-menu-inner .at4m-menu-search input[type=submit]{position:absolute;top:11px;left:14px;width:1pc;height:1pc;background:url(//s7.addthis.com/static/3fc4b18bbb046f074de86a3cb5398353.svg),none;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1NDQxMjk0RDkzRjIxMUUyODgyNEMyRjRCOUU5QTdDNiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1NDQxMjk0RTkzRjIxMUUyODgyNEMyRjRCOUU5QTdDNiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjU0NDEyOTRCOTNGMjExRTI4ODI0QzJGNEI5RTlBN0M2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU0NDEyOTRDOTNGMjExRTI4ODI0QzJGNEI5RTlBN0M2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+RlRfxAAAAOhJREFUeNrEU+0NgkAM5YwD4Aa6AUygTuAIwASck8hNAG7CBrKBjIAT4CvpkSb2/Ag/bNL0CH3vXj/OjOMYLbFVtNDW/mCMmWJVVVuEXOS01tpWgqRq4z+IAOALjla5qAFJoRHMJQCcM7iDHwEgSSkpIEVM/mKzAufcHSGG7wAeZBLAN4QEvqF/qgLYlqUOykVXjsmnKTwCzR6+GSMlZZAbK3kZx/4dgeMyak9CEV7jeKDmorw+2EQeYy12oFNqnsYZ3AMxzhNPxDdwL4ibsiyLIEHIhLoOBOnPb4E38UxLpvbgb6/xKcAAtbllO+gwy6kAAAAASUVORK5CYII=");background-repeat:no-repeat;background-position:0 0;background-position:center bottom\9;border:none;overflow:hidden;text-indent:-9999em;cursor:pointer;opacity:.22}.at4m-menu .at4m-menu-inner .at4m-menu-search input[type=cancel]{position:absolute;top:9pt;right:20px;width:18px;height:18px;background:url(//s7.addthis.com/static/f048274431eaef1b46f80d94f1c18af6.png) no-repeat center center;background-image:url(//s7.addthis.com/static/666b87d14e4d4e526b57292ab8adc465.svg),none;background-size:18px 18px;border:none;overflow:hidden;text-indent:-9999em;opacity:.14}.at4m-menu .at4m-menu-inner .at4m-menu-footer{position:fixed;bottom:0;left:0;right:0;width:100%;height:30px;background:#fff;text-align:left;line-height:1pc;-o-box-shadow:0 -2px 4px rgba(0,0,0,.1);box-shadow:0 -2px 4px rgba(0,0,0,.1)}.at4m-menu .at4m-menu-inner .at4m-menu-footer .at4m-menu-footer-inner{position:relative;height:26px;padding:5px 15px}.at4m-menu .at4m-menu-inner .at4m-menu-footer .at4m-menu-footer-inner .at4m-menu-footer-logo{background:url(//s7.addthis.com/static/5432e2206e5cb0b11874ad11e5a22186.png);background-image:url(//s7.addthis.com/static/f1a5a53cfb4afc0b8231b342c9e39ece.svg),none;background-repeat:no-repeat;background-position:left 2px;background-size:9px 9px;padding-left:9pt}.at4m-menu .at4m-menu-inner .at4m-menu-footer .at4m-menu-footer-inner .at4m-menu-footer-privacy{position:absolute;top:7px;right:15px;background:url(//s7.addthis.com/static/7450d2e11bef7d7c140b197429765a62.png);background-image:url(//s7.addthis.com/static/d714fde79b61d3f511dd5c11ad366e68.svg),none;background-repeat:no-repeat;background-position:right 3px;background-size:8px 9px;padding-right:13px}.at4m-menu .at4m-menu-inner .at4m-menu-footer .at4m-menu-footer-inner a:link,.at4m-menu .at4m-menu-inner .at4m-menu-footer .at4m-menu-footer-inner a:visited{font-size:.714em;text-decoration:none;color:#666}.at4m-menu.abs{border-top:.5px solid #efefef}.at4m-menu.abs,.at4m-menu.abs .at4m-menu-inner .at4m-menu-footer,.at4m-menu.abs .at4m-menu-inner .at4m-menu-header{position:absolute}.at4m-menu .at4m-menu-content{position:relative;padding:0 0 27px}.at4m-menu .at4m-menu-content ul{margin:0;padding:0}.at4m-menu .at4m-menu-content ul li{background:#fff;list-style:none;margin:0;padding:0;border-bottom:1px solid #e7e9ec;-ms-box-sizing:content-box;-o-box-sizing:content-box;box-sizing:content-box}.at4m-menu .at4m-menu-content ul li:hover{background:#f5f5f5}.at4m-menu .at4m-menu-content ul li a{position:relative;display:block;height:2pc;line-height:2pc;padding:9pt 20px 9pt 14px;text-decoration:none;text-align:left;font-family:helvetica neue,helvetica,arial,sans-serif;font-size:1.07em;font-weight:300;color:#444;-ms-box-sizing:content-box;-o-box-sizing:content-box;box-sizing:content-box}.at4m-menu .at4m-menu-content ul li a:active{background-color:#f9f9f9}.at4m-menu .at4m-menu-content ul li a span.at-icon-wrapper{margin:0 9px 0 0;float:left}.at4m-menu .at4m-menu-content ul li a span.at4-label{display:inline-block;height:2pc;line-height:2pc;margin-left:10px}.at4m-menu .at4m-menu-content ul li a span.at4-label.atservice-preferred{font-weight:700}.at4m-menu .at4m-menu-content ul li a span.at4-arrow{display:inline-block;position:absolute;right:5px;background:url(//s7.addthis.com/static/745bc30b589d20aeba08481e06fae159.png);background-image:url(//s7.addthis.com/static/f4d5547a72831e67681d82122e1d563f.svg),none;background-repeat:no-repeat;background-position:center center;width:2pc;height:2pc;text-indent:-9999em;overflow:hidden;opacity:.22}.at4m-menu.ats-dark .at4m-menu-footer,.at4m-menu.ats-dark .at4m-menu-header{background:#262b30;color:#fff}.at4m-menu.ats-dark .at4m-menu-inner .at4m-menu-header button{background:#000;border-color:#333;color:#fff}.at4m-menu.ats-dark .at4m-menu-inner .at4m-menu-header .at4m-menu-header-inner a.at4m-menu-cancel{background:url(//s7.addthis.com/static/5092b14c9020eaa68c3de74da2219940.png) no-repeat center center;background-image:url(//s7.addthis.com/static/fb08f6d50887bd0caacc86a62bcdcf68.svg),none}.at4m-menu.ats-dark .at4m-menu-inner .at4m-menu-footer .at4m-menu-footer-inner a:link,.at4m-menu.ats-dark .at4m-menu-inner .at4m-menu-footer .at4m-menu-footer-inner a:visited{color:#ccc}#at4m-dock:hover{cursor:pointer}#at4m-dock.ats-dark{background:#262b30;border-color:#1b1b1b;color:#fff}#at4m-dock.ats-light{background:#fff;border-color:#c5c5c5}.at4m-dock.ats-dark a,.at4m-dock.ats-dark a:first-child{color:#fff}.at4m-dock.ats-dark a:active,.at4m-dock.ats-dark a:hover{background:#1b1e22}.at-expandedmenu-component .at4m-dock,.at-expandedmenu-component .at4m-dock-toggle{display:none}</style><style type="text/css">#at4-drawer-outer-container{top:0;width:20pc;position:fixed}#at4-drawer-outer-container.at4-drawer-inline{position:relative}#at4-drawer-outer-container.at4-drawer-inline.at4-drawer-right{float:right;right:0;left:auto}#at4-drawer-outer-container.at4-drawer-inline.at4-drawer-left{float:left;left:0;right:auto}#at4-drawer-outer-container.at4-drawer-shown,#at4-drawer-outer-container.at4-drawer-shown *{z-index:999999}#at4-drawer-outer-container,#at4-drawer-outer-container .at4-drawer-outer,#at-drawer{height:100%;overflow-y:auto;overflow-x:hidden}.at4-drawer-push-content-right-back{position:relative;right:0}.at4-drawer-push-content-right{position:relative;left:20pc!important}.at4-drawer-push-content-left-back{position:relative;left:0}.at4-drawer-push-content-left{position:relative;right:20pc!important}#at4-drawer-outer-container.at4-drawer-right{left:auto;right:-20pc}#at4-drawer-outer-container.at4-drawer-left{right:auto;left:-20pc}#at4-drawer-outer-container.at4-drawer-shown.at4-drawer-right{left:auto;right:0}#at4-drawer-outer-container.at4-drawer-shown.at4-drawer-left{right:auto;left:0}#at-drawer{top:0;z-index:9999999;height:100%;-webkit-animation-duration:.4s;animation-duration:.4s}#at-drawer.drawer-push.at-right{right:-20pc}#at-drawer.drawer-push.at-left{left:-20pc}#at-drawer .at-recommended-label{padding:0 0 0 20px;color:#999;line-height:3pc;font-size:18px;font-weight:300;cursor:default}#at-drawer-arrow{width:30px;height:5pc}#at-drawer-arrow.ats-dark{background:#262b30}#at-drawer-arrow.ats-gray{background:#f2f2f2}#at-drawer-open-arrow{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAABcCAYAAAC1OT8uAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk3ODNCQjdERUQ3QjExRTM5NjFGRUZBODc3MTIwMTNCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk3ODNCQjdFRUQ3QjExRTM5NjFGRUZBODc3MTIwMTNCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTc4M0JCN0JFRDdCMTFFMzk2MUZFRkE4NzcxMjAxM0IiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTc4M0JCN0NFRDdCMTFFMzk2MUZFRkE4NzcxMjAxM0IiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7kstzCAAAB4ElEQVR42uyWv0oDQRDGb9dYimgVjliID2Ca9AGfwtZob2Grja1PIFj7EhGCYK99VPBPOkVMp8X5rc6FeN7dfjOksMjAxwXZ3667OzvfLKRr682l5ZV9aDh+fxsnRHhoDzqGLjFBi4XOoFtoAxowoB893o/w7WpAl/+QgQMBwwRdTPhUC2lAV/wDA7qy5WOgq9psHejqTqkKdLE7KYCv0JZjMgBgB58raBG6mP1K6j2pT099T+qMUOeeOss1wDcEIA1PnQXy576rAUI0oFMoC7VCnn40Gs8Pd4lAiXNUKmJ0lh1mPzGEWiyUCqAGW3Pwv4IvUJsFO9CHgP3Zr6Te0xwgAf3LxaAjS241pbikCRkOg+nSJdV4p8HOPl3vvRYI5dtrgVDvvcWovcWovcWovcWovcWovcWovQChWNywNpqvdAKtQp/QNmPUIQ6kwwqt2Xmsxf6GMPM1Pptsbz45CPmXqKb+15Gz4J/LZcDSNIqBlQlbB0afe1mmUDWiCNKFZRq0VKMeXY1CTDq2sJLWsCmoaBBRqNRR6qBKC6qCaj2rDIqaXBGiXHEaom00h1S+K3fVlr6HNuqgvgCh0+owt21bybQn8+mZ78mcEebcM2e5+T2ZX24ZqCph0qn1vgQYAJ/KDpLQr2tPAAAAAElFTkSuQmCC);background-repeat:no-repeat;width:13px;height:23px;margin:28px 0 0 8px}.at-left #at-drawer-open-arrow{background-position:0 -46px}.ats-dark #at-drawer-open-arrow{background-position:0 -23px}.ats-dark.at-left #at-drawer-open-arrow{background-position:0 -69px}#at-drawer-arrow.at4-drawer-modern-browsers{position:fixed;top:40%;background-repeat:no-repeat;background-position:0 0!important;z-index:9999999}.at4-drawer-inline #at-drawer-arrow{position:absolute}#at-drawer-arrow.at4-drawer-modern-browsers.at-right{right:0}#at-drawer-arrow.at4-drawer-modern-browsers.at-left{left:0}.at4-drawer-push-animation-left{-webkit-transition:left .4s ease-in-out .15s;transition:left .4s ease-in-out .15s}.at4-drawer-push-animation-right{-webkit-transition:right .4s ease-in-out .15s;transition:right .4s ease-in-out .15s}#at-drawer.drawer-push.at4-drawer-push-animation-right{right:0}#at-drawer.drawer-push.at4-drawer-push-animation-right-back{right:-20pc!important}#at-drawer.drawer-push.at4-drawer-push-animation-left{left:0}#at-drawer.drawer-push.at4-drawer-push-animation-left-back{left:-20pc!important}#at-drawer .at4-closebutton.drawer-close{content:'X';color:#999;display:block;position:absolute;margin:0;top:0;right:0;width:3pc;height:45px;line-height:45px;overflow:hidden;opacity:.5}#at-drawer.ats-dark .at4-closebutton.drawer-close{color:#fff}#at-drawer .at4-closebutton.drawer-close:hover{opacity:1}#at-drawer.ats-dark.at4-recommended .at4-logo-container a{color:#666}#at-drawer.at4-recommended .at4-recommended-vertical{padding:0}#at-drawer.at4-recommended .at4-recommended-item .sponsored-label{margin:2px 0 0 21px;color:#ddd}#at-drawer.at4-recommended .at4-recommended-vertical .at4-recommended-item{position:relative;padding:0;width:20pc;height:180px;margin:0}#at-drawer.at4-recommended .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-img a:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.65);z-index:1000000;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}#at-drawer.at4-recommended .at4-recommended-vertical .at4-recommended-item.at-hover .at4-recommended-item-img a:after{background:rgba(0,0,0,.8)}#at-drawer .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-img,#at-drawer .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-img a,#at-drawer .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-img img{width:20pc;height:180px;float:none}#at-drawer .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption{width:100%;position:absolute;bottom:0;left:0;height:70px}#at-drawer .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption .at-h4{color:#fff;position:absolute;height:52px;top:0;left:20px;right:20px;margin:0;padding:0;line-height:25px;font-size:20px;font-weight:600;z-index:1000001;text-decoration:none;text-transform:none}#at-drawer.at4-recommended .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption .at-h4 a:hover{text-decoration:none}#at-drawer.at4-recommended .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption .at-h4 a:link{color:#fff}#at-drawer.at4-recommended .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption small{position:absolute;top:auto;bottom:10px;left:20px;width:auto;color:#ccc}#at-drawer.at4-recommended .at4-logo-container{margin-left:20px}#at-drawer.ats-dark.at4-recommended .at4-logo-container a:hover{color:#fff}#at-drawer.at4-recommended .at-logo{margin:0}</style><style type="text/css">.at4-follow.at-mobile{display:none!important}.at4-follow{position:fixed;top:0;right:0;font-weight:400;color:#666;cursor:default;z-index:10001}.at4-follow .at4-follow-inner{position:relative;padding:10px 24px 10px 15px}.at4-follow-inner,.at-follow-open-control{border:0 solid #c5c5c5;border-width:1px 0 1px 1px;margin-top:-1px}.at4-follow .at4-follow-container{margin-left:9pt}.at4-follow.at4-follow-24 .at4-follow-container{height:24px;line-height:23px;font-size:13px}.at4-follow.at4-follow-32 .at4-follow-container{width:15pc;height:2pc;line-height:2pc;font-size:14px}.at4-follow .at4-follow-container .at-follow-label{display:inline-block;height:24px;line-height:24px;margin-right:10px;padding:0;cursor:default;float:left}.at4-follow .at4-follow-container .at-icon-wrapper{height:24px;width:24px}.at4-follow.ats-transparent .at4-follow-inner,.at-follow-open-control.ats-transparent{border-color:transparent}.at4-follow.ats-dark .at4-follow-inner,.at-follow-open-control.ats-dark{background:#262b30;border-color:#000;color:#fff}.at4-follow.ats-dark .at-follow-close-control{background-color:#262b30}.at4-follow.ats-light .at4-follow-inner{background:#fff;border-color:#c5c5c5}.at4-follow.ats-gray .at4-follow-inner,.at-follow-open-control.ats-gray{background:#f2f2f2;border-color:#c5c5c5}.at4-follow.ats-light .at4-follow-close-control,.at-follow-open-control.ats-light{background:#e5e5e5}.at4-follow .at4-follow-inner .at4-follow-close-control{position:absolute;top:0;bottom:0;left:0;width:20px;cursor:pointer;display:none}.at4-follow .at4-follow-inner .at4-follow-close-control div{display:block;line-height:20px;text-indent:-9999em;margin-top:calc(50% + 1px);overflow:hidden}.at-follow-open-control div.at4-arrow.at-left{background-position:0 -2px}.at-follow-open-control{position:fixed;height:35px;top:0;right:0;padding-top:10px;z-index:10002}.at-follow-btn{margin:0 5px 5px 0;padding:0;outline-offset:-1px;display:inline-block;box-sizing:content-box;transition:all .2s ease-in-out}.at-follow-btn:focus,.at-follow-btn:hover{-webkit-transform:translateY(-4px);transform:translateY(-4px)}.at4-follow-24 .at-follow-btn{height:25px;line-height:0;width:25px}</style><style type="text/css">.at-follow-tbx-element .at300b,.at-follow-tbx-element .at300m{display:inline-block;width:auto;padding:0;margin:0 2px 5px;outline-offset:-1px;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.at-follow-tbx-element .at300b:focus,.at-follow-tbx-element .at300b:hover,.at-follow-tbx-element .at300m:focus,.at-follow-tbx-element .at300m:hover{-webkit-transform:translateY(-4px);transform:translateY(-4px)}.at-follow-tbx-element .addthis_vertical_style .at300b,.at-follow-tbx-element .addthis_vertical_style .at300m{display:block}.at-follow-tbx-element .addthis_vertical_style .at300b .addthis_follow_label,.at-follow-tbx-element .addthis_vertical_style .at300b .at-icon-wrapper,.at-follow-tbx-element .addthis_vertical_style .at300m .addthis_follow_label,.at-follow-tbx-element .addthis_vertical_style .at300m .at-icon-wrapper{display:inline-block;vertical-align:middle;margin-right:5px}.at-follow-tbx-element .addthis_vertical_style .at300b:focus,.at-follow-tbx-element .addthis_vertical_style .at300b:hover,.at-follow-tbx-element .addthis_vertical_style .at300m:focus,.at-follow-tbx-element .addthis_vertical_style .at300m:hover{-webkit-transform:none;transform:none}</style><style type="text/css">.at4-jumboshare .at-share-btn{display:inline-block;margin-right:13px;margin-top:13px}.at4-jumboshare .at-share-btn .at-icon{float:left}.at4-jumboshare .at-share-btn .at300bs{display:inline-block;float:left;cursor:pointer}.at4-jumboshare .at4-mobile .at-share-btn .at-icon,.at4-jumboshare .at4-mobile .at-share-btn .at-icon-wrapper{margin:0;padding:0}.at4-jumboshare .at4-mobile .at-share-btn{padding:0}.at4-jumboshare .at4-mobile .at-share-btn .at-label{display:none}.at4-jumboshare .at4-count{font-size:60px;line-height:60px;font-family:Helvetica neue,arial;font-weight:700}.at4-jumboshare .at4-count-container{display:table-cell;text-align:center;min-width:200px;vertical-align:middle;border-right:1px solid #ccc;padding-right:20px}.at4-jumboshare .at4-share-container{display:table-cell;vertical-align:middle;padding-left:20px}.at4-jumboshare .at4-share-container.at-share-tbx-element{padding-top:0}.at4-jumboshare .at4-title{position:relative;font-size:18px;line-height:18px;bottom:2px}.at4-jumboshare .at4-spacer{height:1px;display:block;visibility:hidden;opacity:0}.at4-jumboshare .at-share-btn{display:inline-block;margin:0 2px;line-height:0;padding:0;overflow:hidden;text-decoration:none;text-transform:none;color:#fff;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;border:0;background-color:transparent}.at4-jumboshare .at-share-btn:focus,.at4-jumboshare .at-share-btn:hover{-webkit-transform:translateY(-4px);transform:translateY(-4px);color:#fff;text-decoration:none}.at4-jumboshare .at-label{font-family:helvetica neue,helvetica,arial,sans-serif;font-size:9pt;padding:0 15px 0 0;margin:0;height:2pc;line-height:2pc;background:none}.at4-jumboshare .at-share-btn:hover,.at4-jumboshare .at-share-btn:link{text-decoration:none}.at4-jumboshare .at-share-btn::-moz-focus-inner{border:0;padding:0}.at4-jumboshare.at-mobile .at-label{display:none}</style><style type="text/css">div.at-share-close-control.ats-dark,div.at-share-open-control-left.ats-dark,div.at-share-open-control-right.ats-dark{background:#262b30}div.at-share-close-control.ats-light,div.at-share-open-control-left.ats-light,div.at-share-open-control-right.ats-light{background:#fff}div.at-share-close-control.ats-gray,div.at-share-open-control-left.ats-gray,div.at-share-open-control-right.ats-gray{background:#f2f2f2}.atss{position:fixed;top:20%;width:3pc;z-index:100020;background:none}.at-share-close-control{position:relative;width:3pc;overflow:auto}.at-share-open-control-left{position:fixed;top:20%;z-index:100020;left:0;width:22px}.at-share-close-control .at4-arrow.at-left{float:right}.atss-left{left:0;float:left;right:auto}.atss-right{left:auto;float:right;right:0}.atss-right.at-share-close-control .at4-arrow.at-right{position:relative;right:0;overflow:auto}.atss-right.at-share-close-control .at4-arrow{float:left}.at-share-open-control-right{position:fixed;top:20%;z-index:100020;right:0;width:22px;float:right}.atss-right .at-share-close-control .at4-arrow{float:left}.atss.atss-right a{float:right}.atss.atss-right .at4-share-title{float:right;overflow:hidden}.atss .at-share-btn,.atss a{position:relative;display:block;width:3pc;margin:0;outline-offset:-1px;text-align:center;float:left;-webkit-transition:width .15s ease-in-out;transition:width .15s ease-in-out;overflow:hidden;background:#e8e8e8;z-index:100030;cursor:pointer}.at-share-btn::-moz-focus-inner{border:0;padding:0}.atss-right .at-share-btn{float:right}.atss .at-share-btn{border:0;padding:0}.atss .at-share-btn:focus,.atss .at-share-btn:hover,.atss a:focus,.atss a:hover{width:4pc}.atss .at-share-btn .at-icon-wrapper,.atss a .at-icon-wrapper{display:block;padding:8px 0}.atss .at-share-btn:last-child,.atss a:last-child{border:none}.atss .at-share-btn span .at-icon,.atss a span .at-icon{position:relative;top:0;left:0;display:block;background-repeat:no-repeat;background-position:50% 50%;width:2pc;height:2pc;line-height:2pc;border:none;padding:0;margin:0 auto;overflow:hidden;cursor:pointer;cursor:hand}.at4-share .at-custom-sidebar-counter{font-family:Helvetica neue,arial;vertical-align:top;margin-right:4px;display:inline-block;text-align:center}.at4-share .at-custom-sidebar-count{font-size:17px;line-height:1.25em;color:#222}.at4-share .at-custom-sidebar-text{font-size:9px;line-height:1.25em;color:#888;letter-spacing:1px}.at4-share .at4-share-count-container{position:absolute;left:0;right:auto;top:auto;bottom:0;width:100%;color:#fff;background:inherit}.at4-share .at4-share-count,.at4-share .at4-share-count-container{line-height:1pc;font-size:10px}.at4-share .at4-share-count{text-indent:0;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-weight:200;width:100%;height:1pc}.at4-share .at4-share-count-anchor{padding-bottom:8px;text-decoration:none;-webkit-transition:padding .15s ease-in-out .15s,width .15s ease-in-out;transition:padding .15s ease-in-out .15s,width .15s ease-in-out}</style><style type="text/css">.at4-recommendedbox-outer-container{display:inline}.at4-recommended-outer{position:static}.at4-recommended{top:20%;margin:0;text-align:center;font-weight:400;font-size:13px;line-height:17px;color:#666}.at4-recommended.at-inline .at4-recommended-horizontal{text-align:left}.at4-recommended-recommendedbox{padding:0;z-index:inherit}.at4-recommended-recommended{padding:40px 0}.at4-recommended-horizontal{max-height:340px}.at4-recommended.at-medium .at4-recommended-horizontal{max-height:15pc}.at4-recommended.at4-minimal.at-medium .at4-recommended-horizontal{padding-top:10px;max-height:230px}.at4-recommended-text-only .at4-recommended-horizontal{max-height:130px}.at4-recommended-horizontal{padding-top:5px;overflow-y:hidden}.at4-minimal{background:none;color:#000;border:none!important;box-shadow:none!important}@media screen and (max-width:900px){.at4-recommended-horizontal .at4-recommended-item,.at4-recommended-horizontal .at4-recommended-item .at4-recommended-item-img{width:15pc}}.at4-recommended.at4-minimal .at4-recommended-horizontal .at4-recommended-item .at4-recommended-item-caption{padding:0 0 10px}.at4-recommended.at4-minimal .at4-recommended-horizontal .at4-recommended-item-caption{padding:20px 0 0!important}.addthis-smartlayers .at4-recommended .at-h3.at-recommended-label{margin:0;padding:0;font-weight:300;font-size:18px;line-height:24px;color:#464646;width:100%;display:inline-block;zoom:1}.addthis-smartlayers .at4-recommended.at-inline .at-h3.at-recommended-label{text-align:left}#at4-thankyou .addthis-smartlayers .at4-recommended.at-inline .at-h3.at-recommended-label{text-align:center}.at4-recommended .at4-recommended-item{display:inline-block;zoom:1;position:relative;background:#fff;border:1px solid #c5c5c5;width:200px;margin:10px}.addthis_recommended_horizontal .at4-recommended-item{border:none}.at4-recommended .at4-recommended-item .sponsored-label{color:#666;font-size:9px;position:absolute;top:-20px}.at4-recommended .at4-recommended-item-img .at-tli,.at4-recommended .at4-recommended-item-img a{position:absolute;left:0}.at4-recommended.at-inline .at4-recommended-horizontal .at4-recommended-item{margin:10px 20px 0 0}.at4-recommended.at-medium .at4-recommended-horizontal .at4-recommended-item{margin:10px 10px 0 0}.at4-recommended.at-medium .at4-recommended-item{width:140px;overflow:hidden}.at4-recommended .at4-recommended-item .at4-recommended-item-img{position:relative;text-align:center;width:100%;height:200px;line-height:0;overflow:hidden}.at4-recommended .at4-recommended-item .at4-recommended-item-img a{display:block;width:100%;height:200px}.at4-recommended.at-medium .at4-recommended-item .at4-recommended-item-img,.at4-recommended.at-medium .at4-recommended-item .at4-recommended-item-img a{height:140px}.at4-recommended .at4-recommended-item .at4-recommended-item-img img{position:absolute;top:0;left:0;min-height:0;min-width:0;max-height:none;max-width:none;margin:0;padding:0}.at4-recommended .at4-recommended-item .at4-recommended-item-caption{height:74px;overflow:hidden;padding:20px;text-align:left;-ms-box-sizing:content-box;-o-box-sizing:content-box;box-sizing:content-box}.at4-recommended.at-medium .at4-recommended-item .at4-recommended-item-caption{height:50px;padding:15px}.at4-recommended .at4-recommended-item .at4-recommended-item-caption .at-h4{height:54px;margin:0 0 5px;padding:0;overflow:hidden;word-wrap:break-word;font-size:14px;font-weight:400;line-height:18px;text-align:left}.at4-recommended.at-medium .at4-recommended-item .at4-recommended-item-caption .at-h4{font-size:9pt;line-height:1pc;height:33px}.at4-recommended .at4-recommended-item:hover .at4-recommended-item-caption .at-h4{text-decoration:underline}.at4-recommended a:link,.at4-recommended a:visited{text-decoration:none;color:#464646}.at4-recommended .at4-recommended-item .at4-recommended-item-caption .at-h4 a:hover{text-decoration:underline;color:#000}.at4-recommended .at4-recommended-item .at4-recommended-item-caption small{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:11px;color:#666}.at4-recommended.at-medium .at4-recommended-item .at4-recommended-item-caption small{font-size:9px}.at4-recommended .at4-recommended-vertical{padding:15px 0 0}.at4-recommended .at4-recommended-vertical .at4-recommended-item{display:block;width:auto;max-width:100%;height:60px;border:none;margin:0 0 15px;box-shadow:none;background:none}.at4-recommended-vertical .at4-recommended-item .at4-recommended-item-img,.at4-recommended-vertical .at4-recommended-item .at4-recommended-item-img img{width:60px;height:60px;float:left}.at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption{border-top:none;margin:0;height:60px;padding:3px 5px}.at4-recommended .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption .at-h4{height:38px;margin:0}.at4-recommended .at4-recommended-vertical .at4-recommended-item .at4-recommended-item-caption small{position:absolute;bottom:0}.at4-recommended .at-recommended-label.at-vertical{text-align:left}.at4-no-image-light-recommended,.at4-no-image-minimal-recommended{background-color:#f2f2f2!important}.at4-no-image-gray-recommended{background-color:#e6e6e5!important}.at4-no-image-dark-recommended{background-color:#4e555e!important}.at4-recommended .at4-recommended-item-placeholder-img{background-repeat:no-repeat!important;background-position:center!important;width:100%!important;height:100%!important}.at4-recommended-horizontal .at4-no-image-dark-recommended .at4-recommended-item-placeholder-img{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAfCAYAAACCox+xAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlFNUUyQTg3MTI0RDExRTM4NzAwREJDRjlCQzAyMUVFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlFNUUyQTg4MTI0RDExRTM4NzAwREJDRjlCQzAyMUVFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUU1RTJBODUxMjREMTFFMzg3MDBEQkNGOUJDMDIxRUUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUU1RTJBODYxMjREMTFFMzg3MDBEQkNGOUJDMDIxRUUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6oCfPiAAABfUlEQVR42uyWTU/DMAyGm3bdBxp062hHe+PC//9HCIkDYpNAO7CPAuWN5Eohyhpno2GHWqq8pO78xHHsiLquH4L/l6cwuBAZaOPKs//YBFIJIR59UiAt7huYi90aE/UQakTDLaL26RUEAAJqiefm93T9Bpj1X4O0bY0OIUXCpYBJvYDAUWyAUCWliHGTcnpqRMaM72ImRAJVknYG+eb4YEDIBeU0zGnsBLK1ODogYSsLhDwIJeVVk18lzfNA4ERGZNXi59UCIQhiYDilpSm/jp4awLxDvWhlf4/nGe8+LLuSt+SZul28ggaHG6gNVhDR+IuRFzOoxGKWwG7vVFm5AAQxgcqYpzrjFjR9zwPH5LSuT7XlNr2MQm5LzqjLpncNNaM+s8M27Y60g3FwhoSMzrtUQllgLtRs5pZ2cB4IhbvQbGRZv1NsrhyS8+SI5Mo9RJWpjAI1xqKL+0iEP180vy214JbeR12AyOgsHI7e0NfFyKv0ID1ID+IqPwIMAOeljGQOryBmAAAAAElFTkSuQmCC)!important}.at4-recommended-vertical .at4-no-image-dark-recommended .at4-recommended-item-placeholder-img{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAOCAYAAADwikbvAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAzREMyNTM2MTI0RjExRTM4NzAwREJDRjlCQzAyMUVFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAzREMyNTM3MTI0RjExRTM4NzAwREJDRjlCQzAyMUVFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDNEQzI1MzQxMjRGMTFFMzg3MDBEQkNGOUJDMDIxRUUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDNEQzI1MzUxMjRGMTFFMzg3MDBEQkNGOUJDMDIxRUUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5GfbtkAAAAxklEQVR42qRSTQvCMAxduk53mEOHKFPP/v8/5cGTiIibivVFUomlG7gFHvloXpKmJefcPhkmNyvGEWj+IOZA6ckPImoxxVwOLvCvXUzkpayNCpRQK64IbOBnAYGAXMeMslNlU+CzrIEdCkxi5DPAoz6BE8ZuVNdKJuL8rS9sv62IXlCHyP0KqKUKZXK9uwkSLVArfwpVR3b225kXwovibcP+jC4jUtfWPZmfqJJnYlkAM128j1z0nHWKSUbIKDL/msHktwADAPptQo+vkZNLAAAAAElFTkSuQmCC)!important}.at4-recommended-horizontal .at4-no-image-gray-recommended .at4-recommended-item-placeholder-img,.at4-recommended-horizontal .at4-no-image-light-recommended .at4-recommended-item-placeholder-img,.at4-recommended-horizontal .at4-no-image-minimal-recommended .at4-recommended-item-placeholder-img{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAfCAYAAACCox+xAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAzREMyNTMyMTI0RjExRTM4NzAwREJDRjlCQzAyMUVFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAzREMyNTMzMTI0RjExRTM4NzAwREJDRjlCQzAyMUVFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUU1RTJBODkxMjREMTFFMzg3MDBEQkNGOUJDMDIxRUUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUU1RTJBOEExMjREMTFFMzg3MDBEQkNGOUJDMDIxRUUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6dfDQvAAABg0lEQVR42uyWS0vDQBDH82jaKNW0qUltbl68e/Di98eLBz+CCB5EBaWIpUat/4UJLMuame1j7SEDYbqbKfPLvHbDi8ur8+D/5T4K9kR6xrr27D+xgdS3N9d3PilQFmcNzN6mxkbdhxrQcoGofXkFAUAINcVzrG2vsP8KmJdtg7SlxoRQouBywOReQOAosUDoklPEpEU5XDciqeB/iRAig6pIO4P8CHysBBDqg0palrR2Alkwjj5RsDUDoRqhorpq6quifRkInKiIPLf4eWIgQoLoWbq0stXXn10DmDeoR2PsL/E84N0Hk5Wypc70dMkGGhzOoeb4gpjW34K6GEFljFkGu6XTZJUCEMQBVCHs6kI60MycB47FyUmo20oPvYJCzhVnvIsR3zg5ghoRTNpyHKTBBhIJTt6pFsoZ9iLDZswcB5uBULhnho0a66eazaFDca59Hym1e4guQ4rCO4Fu/T4Sw8Gk+c3MghN6H+8CRKVg4tB6fV8XI6/SgXQgHYir/AowAMU5TskhKVUNAAAAAElFTkSuQmCC)!important}.at4-recommended-vertical .at4-no-image-gray-recommended .at4-recommended-item-placeholder-img,.at4-recommended-vertical .at4-no-image-light-recommended .at4-recommended-item-placeholder-img,.at4-recommended-vertical .at4-no-image-minimal-recommended .at4-recommended-item-placeholder-img{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAOCAYAAADwikbvAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAzREMyNTNBMTI0RjExRTM4NzAwREJDRjlCQzAyMUVFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAzREMyNTNCMTI0RjExRTM4NzAwREJDRjlCQzAyMUVFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDNEQzI1MzgxMjRGMTFFMzg3MDBEQkNGOUJDMDIxRUUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDNEQzI1MzkxMjRGMTFFMzg3MDBEQkNGOUJDMDIxRUUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz65Fr9cAAAA0ElEQVR42qRRuQrCQBDd3SSaIgYNosSrtLew8f+xsfAnYmEVRMR4YHwjExjCbsBk4DHHzptjR2+2u7VqJ3efjTNQ/EEMgbgiv46H/QNTDPnhCv/mYiLPI21EIIaaUEVgBj+oETQQypgRtidsXfNJpsACBXo28gWgUd9AjrEL0TXhiSh/XhWudlZI/kCdLPtFUGMRCni9p6kl+kAq/D5UavmzX2fNd87obsCSfztnrOR0rjvTiRImkoyAQQNRyZ2jhjenGNVBOpF1WZatyV8BBgBJ+irgS/KHdAAAAABJRU5ErkJggg==)!important}#at-drawer.ats-dark,.at4-recommended.ats-dark .at4-recommended-horizontal .at4-recommended-item-caption,.at4-recommended.ats-dark .at4-recommended-vertical .at4-recommended-item-caption{background:#262b30}#at-drawer.ats-gray,.at4-recommended.ats-gray .at4-recommended-horizontal .at4-recommended-item-caption{background:#f2f2f2}#at-drawer.ats-light,.at4-recommended.ats-light .at4-recommended-horizontal .at4-recommended-item-caption{background:#fff}.at4-recommended.ats-dark .at4-recommended-vertical .at4-recommended-item{background:none}.at4-recommended.ats-dark .at4-recommended-item .at4-recommended-item-caption a:hover,.at4-recommended.ats-dark .at4-recommended-item .at4-recommended-item-caption a:link,.at4-recommended.ats-dark .at4-recommended-item .at4-recommended-item-caption a:visited,.at4-recommended.ats-dark .at4-recommended-item .at4-recommended-item-caption small,.at4-recommended.ats-dark .at4-recommended-item-caption,.at4-recommended.ats-dark .at-logo a:hover,.at4-recommended.ats-dark .at-recommended-label.at-vertical{color:#fff}.at4-recommended-vertical-logo{padding-top:0;text-align:left}.at4-recommended-vertical-logo .at4-logo-container{line-height:10px}.at4-recommended-horizontal-logo{text-align:center}.at4-recommended.at-inline .at4-recommended-horizontal-logo{text-align:left}#at4-thankyou .at4-recommended.at-inline .at4-recommended-horizontal{text-align:center}.at4-recommended .at-logo{margin:10px 0 0;padding:0;height:25px;overflow:auto;-ms-box-sizing:content-box;-o-box-sizing:content-box;box-sizing:content-box}.at4-recommended.at-inline .at4-recommended-horizontal .at-logo{text-align:left}.at4-recommended .at4-logo-container a.at-sponsored-link{color:#666}.at4-recommended-class .at4-logo-container a:hover,.at4-recommendedbox-outer-container .at4-recommended-recommendedbox .at4-logo-container a:hover{color:#000}</style><style type="text/css">.at-recommendedjumbo-outer-container{margin:0;padding:0;border:0;background:none;color:#000}.at-recommendedjumbo-footer{position:relative;width:100%;height:510px;overflow:hidden;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}.at-mobile .at-recommendedjumbo-footer{height:250px}.at-recommendedjumbo-footer #bg-link:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.75)}.at-recommendedjumbo-footer:hover #bg-link:after{background:rgba(0,0,0,.85)}.at-recommendedjumbo-footer *,.at-recommendedjumbo-footer :after,.at-recommendedjumbo-footer :before{box-sizing:border-box}.at-recommendedjumbo-footer:hover #at-recommendedjumbo-footer-bg{-webkit-animation:atRecommendedJumboAnimatedBackground 1s ease-in-out 1;animation:atRecommendedJumboAnimatedBackground 1s ease-in-out 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.at-recommendedjumbo-footer #at-recommendedjumbo-top-holder{position:absolute;top:0;padding:0 40px;width:100%}.at-mobile .at-recommendedjumbo-footer #at-recommendedjumbo-top-holder{padding:0 20px}.at-recommendedjumbo-footer .at-recommendedjumbo-footer-inner{position:relative;text-align:center;font-family:helvetica,arial,sans-serif;z-index:2;width:100%}.at-recommendedjumbo-footer #at-recommendedjumbo-label-holder{margin:40px 0 0;max-height:30px}.at-mobile .at-recommendedjumbo-footer #at-recommendedjumbo-label-holder{margin:20px 0 0;max-height:20px}.at-recommendedjumbo-footer #at-recommendedjumbo-label{font-weight:300;font-size:24px;line-height:24px;color:#fff;margin:0}.at-mobile .at-recommendedjumbo-footer #at-recommendedjumbo-label{font-weight:150;font-size:14px;line-height:14px}.at-recommendedjumbo-footer #at-recommendedjumbo-title-holder{margin:20px 0 0;min-height:3pc;max-height:78pt}.at-mobile .at-recommendedjumbo-footer #at-recommendedjumbo-title-holder{margin:10px 0 0;min-height:24px;max-height:54px}.at-recommendedjumbo-footer #at-recommendedjumbo-content-title{font-size:3pc;line-height:52px;font-weight:700;margin:0}.at-mobile .at-recommendedjumbo-footer #at-recommendedjumbo-content-title{font-size:24px;line-height:27px}.at-recommendedjumbo-footer a{text-decoration:none;color:#fff}.at-recommendedjumbo-footer a:visited{color:#fff}.at-recommendedjumbo-footer small{margin:20px 0 0;display:inline-block;height:2pc;line-height:2pc;font-size:14px;color:#ccc;cursor:default}.at-mobile .at-recommendedjumbo-footer small{margin:10px 0 0;height:14px;line-height:14px;font-size:9pt}.at-recommendedjumbo-footer .at-logo-container{position:absolute;bottom:20px;margin:auto;left:0;right:0}.at-mobile .at-recommendedjumbo-footer .at-logo-container{bottom:10px}.at-recommendedjumbo-footer a.at-sponsored-link{color:#ccc}.at-recommendedjumbo-footer div #at-recommendedjumbo-logo-link{padding:2px 0 0 11px;text-decoration:none;line-height:20px;font-family:helvetica,arial,sans-serif;font-size:9px;color:#ccc}@-webkit-keyframes atRecommendedJumboAnimatedBackground{0%{-webkit-transform:scale(1,1);transform:scale(1,1)}to{-webkit-transform:scale(1.1,1.1);transform:scale(1.1,1.1)}}@keyframes atRecommendedJumboAnimatedBackground{0%{-webkit-transform:scale(1,1);transform:scale(1,1)}to{-webkit-transform:scale(1.1,1.1);transform:scale(1.1,1.1)}}</style><style type="text/css">.at-resp-share-element{position:relative;padding:0;margin:0;font-size:0;line-height:0}.at-resp-share-element:after,.at-resp-share-element:before{content:" ";display:table}.at-resp-share-element.at-mobile .at4-share-count-container,.at-resp-share-element.at-mobile .at-label{display:none}.at-resp-share-element .at-share-btn{display:inline-block;*display:inline;*zoom:1;margin:0 2px 5px;padding:0;overflow:hidden;line-height:0;text-decoration:none;text-transform:none;color:#fff;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;border:0;font-family:helvetica neue,helvetica,arial,sans-serif;background-color:transparent}.at-resp-share-element .at-share-btn::-moz-focus-inner{border:0;padding:0}.at-resp-share-element .at-share-btn:focus,.at-resp-share-element .at-share-btn:hover{-webkit-transform:translateY(-4px);transform:translateY(-4px);color:#fff;text-decoration:none}.at-resp-share-element .at-share-btn .at-icon-wrapper{float:left}.at-resp-share-element .at-share-btn.at-share-btn.at-svc-compact:hover{-webkit-transform:none;transform:none}.at-resp-share-element .at-share-btn .at-label{font-family:helvetica neue,helvetica,arial,sans-serif;font-size:9pt;padding:0 15px 0 0;margin:0 0 0 5px;height:2pc;line-height:2pc;background:none}.at-resp-share-element .at-icon,.at-resp-share-element .at-label{cursor:pointer}.at-resp-share-element .at4-share-count-container{text-decoration:none;float:right;padding-right:15px;font-size:9pt}.at-mobile .at-resp-share-element .at-label{display:none}.at-resp-share-element.at-mobile .at-share-btn{margin-right:5px}.at-mobile .at-resp-share-element .at-share-btn{padding:5px;margin-right:5px}</style><style type="text/css">.at-share-tbx-element{position:relative;margin:0;color:#fff;font-size:0}.at-share-tbx-element,.at-share-tbx-element .at-share-btn{font-family:helvetica neue,helvetica,arial,sans-serif;padding:0;line-height:0}.at-share-tbx-element .at-share-btn{cursor:pointer;margin:0 5px 5px 0;display:inline-block;overflow:hidden;border:0;text-decoration:none;text-transform:none;background-color:transparent;color:inherit;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.at-share-tbx-element .at-share-btn:focus,.at-share-tbx-element .at-share-btn:hover{-webkit-transform:translateY(-4px);transform:translateY(-4px);outline-offset:-1px;color:inherit}.at-share-tbx-element .at-share-btn::-moz-focus-inner{border:0;padding:0}.at-share-tbx-element .at-share-btn.at-share-btn.at-svc-compact:hover{-webkit-transform:none;transform:none}.at-share-tbx-element .at-icon-wrapper{vertical-align:middle}.at-share-tbx-element .at4-share-count,.at-share-tbx-element .at-label{margin:0 7.5px 0 2.5px;text-decoration:none;vertical-align:middle;display:inline-block;background:none;height:0;font-size:inherit;line-height:inherit;color:inherit}.at-share-tbx-element.at-mobile .at4-share-count,.at-share-tbx-element.at-mobile .at-label{display:none}.at-share-tbx-element .at_native_button{vertical-align:middle}.at-share-tbx-element .addthis_counter.addthis_bubble_style{margin:0 2px;vertical-align:middle;display:inline-block}.at-share-tbx-element .fb_iframe_widget{display:block}.at-share-tbx-element.at-share-tbx-native .at300b{vertical-align:middle}.at-style-responsive .at-share-btn{padding:5px}.at-style-jumbo{display:table}.at-style-jumbo .at4-spacer{height:1px;display:block;visibility:hidden;opacity:0}.at-style-jumbo .at4-count-container{display:table-cell;text-align:center;min-width:200px;vertical-align:middle;border-right:1px solid #ccc;padding-right:20px}.at-style-jumbo .at4-count{font-size:60px;line-height:60px;font-weight:700}.at-style-jumbo .at4-count-title{position:relative;font-size:18px;line-height:18px;bottom:2px}.at-style-jumbo .at-share-btn-elements{display:table-cell;vertical-align:middle;padding-left:20px}.at_flat_counter{cursor:pointer;font-family:helvetica,arial,sans-serif;font-weight:700;text-transform:uppercase;display:inline-block;position:relative;vertical-align:top;height:100%;margin:0 5px;padding:0 6px;left:-1px;background:#ebebeb;color:#32363b;-webkit-transition:all .2s ease;transition:all .2s ease}.at_flat_counter:after{top:30%;left:-4px;content:"";position:absolute;border-width:5px 8px 5px 0;border-style:solid;border-color:transparent #ebebeb transparent transparent;display:block;width:0;height:0;-webkit-transform:translateY(360deg);transform:translateY(360deg)}.at_flat_counter:hover{background:#e1e2e2}</style><style type="text/css">.at4-thankyou-background{top:0;right:0;left:0;bottom:0;-webkit-overflow-scrolling:touch;z-index:9999999;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpizCuu/sRABGBiIBKMKqSOQoAAAwC8KgJipENhxwAAAABJRU5ErkJggg==);background:hsla(217,6%,46%,.95)}.at4-thankyou-background.at-thankyou-shown{position:fixed}.at4-thankyou-inner{position:absolute;width:100%;top:10%;left:50%;margin-left:-50%;text-align:center}.at4-thankyou-mobile .at4-thankyou-inner{top:5%}.thankyou-description{font-weight:400}.at4-thankyou-background .at4lb-inner{position:relative;width:100%;height:100%}.at4-thankyou-background .at4lb-inner .at4x{position:absolute;top:15px;right:15px;display:block;width:20px;height:20px;padding:20px;margin:0;cursor:pointer;-webkit-transition:opacity .25s ease-in;transition:opacity .25s ease-in;opacity:.4;background:url("data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAWdEVYdENyZWF0aW9uIFRpbWUAMTEvMTMvMTKswDp5AAAAd0lEQVQ4jb2VQRLAIAgDE///Z3qqY1FAhalHMCsCIkVEAIAkkVgvp2lDBgYAnAyHkWotLccNrEd4A7X2TqIdqLfnWBAdaF5rJdyJfjtPH5GT37CaGhoVq3nOm/XflUuLUto2pY1d+vRKh0Pp+MrAVtDe2JkvYNQ+jVSEEFmOkggAAAAASUVORK5CYII=") no-repeat center center;overflow:hidden;text-indent:-99999em;border:1px solid transparent}.at4-thankyou-background .at4lb-inner .at4x:focus,.at4-thankyou-background .at4lb-inner .at4x:hover{border:1px solid #fff;border-radius:50%;outline:0}.at4-thankyou-background .at4lb-inner #at4-palogo{position:absolute;bottom:10px;display:inline-block;text-decoration:none;font-family:helvetica,arial,sans-serif;font-size:11px;cursor:pointer;-webkit-transition:opacity .25s ease-in;moz-transition:opacity .25s ease-in;transition:opacity .25s ease-in;opacity:.5;z-index:100020;color:#fff;padding:2px 0 0 13px}.at4-thankyou-background .at4lb-inner #at4-palogo .at-branding-addthis,.at4-thankyou-background .at4lb-inner #at4-palogo .at-branding-info{color:#fff}.at4-thankyou-background .at4lb-inner #at4-palogo:hover,.at4-thankyou-background.ats-dark .at4lb-inner a#at4-palogo:hover{text-decoration:none;color:#fff;opacity:1}.at4-thankyou-background.ats-dark{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABtJREFUeNpiZGBgeMZABGBiIBKMKqSOQoAAAwB+cQD6hqlbCwAAAABJRU5ErkJggg==");background:rgba(0,0,0,.85)}.at4-thankyou-background .thankyou-title{color:#fff;font-size:38.5px;margin:10px 20px;line-height:38.5px;font-family:helvetica neue,helvetica,arial,sans-serif;font-weight:300}.at4-thankyou-background.ats-dark .thankyou-description,.at4-thankyou-background.ats-dark .thankyou-title{color:#fff}.at4-thankyou-background .thankyou-description{color:#fff;font-size:18px;margin:10px 0;line-height:24px;padding:0;font-family:helvetica neue,helvetica,arial,sans-serif;font-weight:300}.at4-thankyou-background .at4-thanks-icons{padding-top:10px}.at4-thankyou-mobile *{-webkit-overflow-scrolling:touch}#at4-thankyou .at4-recommended-recommendedbox .at-logo{display:none}.at4-thankyou .at-h3{height:49px;line-height:49px;margin:0 50px 0 20px;padding:1px 0 0;font-family:helvetica neue,helvetica,arial,sans-serif;font-size:1pc;font-weight:700;color:#fff;text-shadow:0 1px #000}.at4-thanks{padding-top:50px;text-align:center}.at4-thanks label{display:block;margin:0 0 15px;font-size:1pc;line-height:1pc}.at4-thanks .at4-h2{background:none;border:none;margin:0 0 10px;padding:0;font-family:helvetica neue,helvetica,arial,sans-serif;font-size:28px;font-weight:300;color:#000}.at4-thanks .at4-thanks-icons{position:relative;height:2pc}.at4-thanks .at4-thanks-icons .at-thankyou-label{display:block;padding-bottom:10px;font-size:14px;color:#666}.at4-thankyou-layer .at-follow .at-icon-wrapper{width:2pc;height:2pc}</style><style type="text/css">.at4-recommended-toaster{position:fixed;top:auto;bottom:0;right:0;z-index:100021}.at4-recommended-toaster.ats-light{border:1px solid #c5c5c5;background:#fff}.at4-recommended-toaster.ats-gray{border:1px solid #c5c5c5;background:#f2f2f2}.at4-recommended-toaster.ats-dark{background:#262b30;color:#fff}.at4-recommended-toaster .at4-recommended-container{padding-top:0;margin:0}.at4-recommended.at4-recommended-toaster div.at-recommended-label{line-height:1pc;font-size:1pc;text-align:left;padding:20px 0 0 20px}.at4-toaster-outer .at4-recommended .at4-recommended-item .at4-recommended-item-caption .at-h4{font-size:11px;line-height:11px;margin:10px 0 6px;height:30px}.at4-recommended.at4-recommended-toaster div.at-recommended-label.ats-gray,.at4-recommended.at4-recommended-toaster div.at-recommended-label.ats-light{color:#464646}.at4-recommended.at4-recommended-toaster div.at-recommended-label.ats-dark{color:#fff}.at4-toaster-close-control{position:absolute;top:0;right:0;display:block;width:20px;height:20px;line-height:20px;margin:5px 5px 0 0;padding:0;text-indent:-9999em}.at4-toaster-open-control{position:fixed;right:0;bottom:0;z-index:100020}.at4-toaster-outer .at4-recommended-item{width:90pt;border:0;margin:9px 10px 0}.at4-toaster-outer .at4-recommended-item:first-child{margin-left:20px}.at4-toaster-outer .at4-recommended-item:last-child{margin-right:20px}.at4-toaster-outer .at4-recommended-item .at4-recommended-item-img{max-height:90pt;max-width:90pt}.at4-toaster-outer .at4-recommended-item .at4-recommended-item-img img{height:90pt;width:90pt}.at4-toaster-outer .at4-recommended-item .at4-recommended-item-caption{height:30px;padding:0;margin:0;height:initial}.at4-toaster-outer .ats-dark .at4-recommended-item .at4-recommended-item-caption{background:#262b30}.at4-toaster-outer .at4-recommended .at4-recommended-item .at4-recommended-item-caption small{width:auto;line-height:14px;margin:0}.at4-toaster-outer .at4-recommended.ats-dark .at4-recommended-item .at4-recommended-item-caption small{color:#fff}.at4-recommended-toaster .at-logo{margin:0 0 3px 20px;text-align:left}.at4-recommended-toaster .at-logo .at4-logo-container.at-sponsored-logo{position:relative}.at4-toaster-outer .at4-recommended-item .sponsored-label{text-align:right;font-size:10px;color:#666;float:right;position:fixed;bottom:6px;right:20px;top:initial;z-index:99999}</style><style type="text/css">.at4-whatsnext{position:fixed;bottom:0!important;right:0;background:#fff;border:1px solid #c5c5c5;margin:-1px;width:390px;height:90pt;overflow:hidden;font-size:9pt;font-weight:400;color:#000;z-index:1800000000}.at4-whatsnext a{color:#666}.at4-whatsnext .at-whatsnext-content{height:90pt;position:relative}.at4-whatsnext .at-whatsnext-content .at-branding{position:absolute;bottom:15px;right:10px;padding-left:9px;text-decoration:none;line-height:10px;font-family:helvetica,arial,sans-serif;font-size:10px;color:#666}.at4-whatsnext .at-whatsnext-content .at-whatsnext-content-inner{position:absolute;top:15px;right:20px;bottom:15px;left:140px;text-align:left;height:105px}.at4-whatsnext .at-whatsnext-content-inner a{display:inline-block}.at4-whatsnext .at-whatsnext-content-inner div.at-h6{text-align:left;margin:0;padding:0 0 3px;font-size:11px;color:#666;cursor:default}.at4-whatsnext .at-whatsnext-content .at-h3{text-align:left;margin:5px 0;padding:0;line-height:1.2em;font-weight:400;font-size:14px;height:3pc}.at4-whatsnext .at-whatsnext-content-inner a:link,.at4-whatsnext .at-whatsnext-content-inner a:visited{text-decoration:none;font-weight:400;color:#464646}.at4-whatsnext .at-whatsnext-content-inner a:hover{color:#000}.at4-whatsnext .at-whatsnext-content-inner small{position:absolute;bottom:15px;line-height:10px;font-size:11px;color:#666;cursor:default;text-align:left}.at4-whatsnext .at-whatsnext-content .at-whatsnext-content-img{position:absolute;top:0;left:0;width:90pt;height:90pt;overflow:hidden}.at4-whatsnext .at-whatsnext-content .at-whatsnext-content-img img{position:absolute;top:0;left:0;max-height:none;max-width:none}.at4-whatsnext .at-whatsnext-close-control{position:absolute;top:0;right:0;display:block;width:20px;height:20px;line-height:20px;margin:0 5px 0 0;padding:0;text-indent:-9999em}.at-whatsnext-open-control{position:fixed;right:0;bottom:0;z-index:100020}.at4-whatsnext.ats-dark{background:#262b30}.at4-whatsnext.ats-dark .at-whatsnext-content .at-h3,.at4-whatsnext.ats-dark .at-whatsnext-content a.at4-logo:hover,.at4-whatsnext.ats-dark .at-whatsnext-content-inner a:link,.at4-whatsnext.ats-dark .at-whatsnext-content-inner a:visited{color:#fff}.at4-whatsnext.ats-light{background:#fff}.at4-whatsnext.ats-gray{background:#f2f2f2}.at4-whatsnext.at-whatsnext-nophoto{width:270px}.at4-whatsnext.at-whatsnext-nophoto .at-whatsnext-content-img{display:none}.at4-whatsnext.at-whatsnext-nophoto .at-whatsnext-content .at-whatsnext-content-inner{top:15px;right:0;left:20px}.at4-whatsnext.at-whatsnext-nophoto .at-whatsnext-content .at-whatsnext-content-inner.addthis_32x32_style{top:0;right:0;left:0;padding:45px 20px 0;font-size:20px}.at4-whatsnext.at-whatsnext-nophoto .at-whatsnext-content .at-whatsnext-content-inner .at4-icon,.at4-whatsnext.at-whatsnext-nophoto .at-whatsnext-content .at-whatsnext-content-inner .at4-icon-fw,.at4-whatsnext.at-whatsnext-nophoto .at-whatsnext-content .at-whatsnext-content-inner .whatsnext-msg{vertical-align:middle}.at-whatsnext-img,.at-whatsnext-img-lnk{position:absolute;left:0}</style><style type="text/css">.at4-whatsnextmobile{position:fixed;bottom:0;right:0;left:0;background:#fff;z-index:9999998;height:170px;font-size:28px}.at4-whatsnextmobile .col-2{height:100%;font-size:1em}.at4-whatsnextmobile .col-2:first-child{max-width:200px;display:inline-block;float:left}.at4-whatsnextmobile .col-2:last-child{position:absolute;left:200px;right:50px;top:0;bottom:0;display:inline-block}.at4-whatsnextmobile .at-whatsnext-content-inner{font-size:1em}.at4-whatsnextmobile .at-whatsnext-content-img img{height:100%;width:100%}.at4-whatsnextmobile .at-close-control{font-size:1em;position:absolute;top:0;right:0;width:50px;height:50px}.at4-whatsnextmobile .at-close-control button{width:100%;height:100%;font-size:1em;font-weight:400;text-decoration:none;opacity:.5;padding:0;cursor:pointer;background:0 0;border:0;-webkit-appearance:none}.at4-whatsnextmobile .at-h3,.at4-whatsnextmobile .at-h6{font-size:1em;margin:0;color:#a1a1a1;margin-left:2.5%;margin-top:25px}.at4-whatsnextmobile .at-h3{font-size:1em;line-height:1em;font-weight:500;height:50%}.at4-whatsnextmobile .at-h3 a{font-size:1em;text-decoration:none}.at4-whatsnextmobile .at-h6{font-size:.8em;line-height:.8em;font-weight:500}.at4-whatsnextmobile .footer{position:absolute;bottom:2px;left:200px;right:0;padding-left:2.5%;font-size:1em;line-height:.6em}.at4-whatsnextmobile .footer small{font-size:.6em;color:#a1a1a1}.at4-whatsnextmobile .footer small:first-child{margin-right:5%;float:left}.at4-whatsnextmobile .footer small:last-child{margin-right:2.5%;float:right}.at4-whatsnextmobile .at-whatsnext-content{height:100%}.at4-whatsnextmobile.ats-dark{background:#262b30;color:#fff}.at4-whatsnextmobile .at-close-control button{color:#bfbfbf}.at4-whatsnextmobile.ats-dark a:link,.at4-whatsnextmobile.ats-dark a:visited{color:#fff}.at4-whatsnextmobile.ats-gray{background:#f2f2f2;color:#262b30}.at4-whatsnextmobile.ats-light{background:#fff;color:#262b30}.at4-whatsnextmobile.ats-dark .footer a:link,.at4-whatsnextmobile.ats-dark .footer a:visited,.at4-whatsnextmobile.ats-gray .footer a:link,.at4-whatsnextmobile.ats-gray .footer a:visited,.at4-whatsnextmobile.ats-light .footer a:link,.at4-whatsnextmobile.ats-light .footer a:visited{color:#a1a1a1}.at4-whatsnextmobile.ats-gray a:link,.at4-whatsnextmobile.ats-gray a:visited,.at4-whatsnextmobile.ats-light a:link,.at4-whatsnextmobile.ats-light a:visited{color:#262b30}@media only screen and (min-device-width:320px) and (max-device-width:480px){.at4-whatsnextmobile{height:85px;font-size:14px}.at4-whatsnextmobile .col-2:first-child{width:75pt}.at4-whatsnextmobile .col-2:last-child{right:25px;left:75pt}.at4-whatsnextmobile .footer{left:75pt}.at4-whatsnextmobile .at-close-control{width:25px;height:25px}.at4-whatsnextmobile .at-h3,.at4-whatsnextmobile .at-h6{margin-top:12.5px}}</style><style type="text/css">.at-custom-mobile-bar{left:0;right:0;width:100%;height:56px;position:fixed;text-align:center;z-index:100020;background:#fff;overflow:hidden;box-shadow:0 0 10px 0 rgba(0,0,0,.2);font:initial;line-height:normal;top:auto;bottom:0}.at-custom-mobile-bar.at-custom-mobile-bar-zindex-hide{z-index:-1!important}.at-custom-mobile-bar.atss-top{top:0;bottom:auto}.at-custom-mobile-bar.atss-bottom{top:auto;bottom:0}.at-custom-mobile-bar .at-custom-mobile-bar-btns{display:inline-block;text-align:center}.at-custom-mobile-bar .at-custom-mobile-bar-counter,.at-custom-mobile-bar .at-share-btn{margin-top:4px}.at-custom-mobile-bar .at-share-btn{display:inline-block;text-decoration:none;-webkit-transition:none;transition:none;box-sizing:content-box}.at-custom-mobile-bar .at-custom-mobile-bar-counter{font-family:Helvetica neue,arial;vertical-align:top;margin-left:4px;margin-right:4px;display:inline-block}.at-custom-mobile-bar .at-custom-mobile-bar-count{font-size:26px;line-height:1.25em;color:#222}.at-custom-mobile-bar .at-custom-mobile-bar-text{font-size:9pt;line-height:1.25em;color:#888;letter-spacing:1px}.at-custom-mobile-bar .at-icon-wrapper{text-align:center;height:3pc;width:3pc;margin:0 4px}.at-custom-mobile-bar .at-icon{vertical-align:top;margin:8px;width:2pc;height:2pc}.at-custom-mobile-bar.at-shfs-medium{height:3pc}.at-custom-mobile-bar.at-shfs-medium .at-custom-mobile-bar-counter{margin-top:6px}.at-custom-mobile-bar.at-shfs-medium .at-custom-mobile-bar-count{font-size:18px}.at-custom-mobile-bar.at-shfs-medium .at-custom-mobile-bar-text{font-size:10px}.at-custom-mobile-bar.at-shfs-medium .at-icon-wrapper{height:40px;width:40px}.at-custom-mobile-bar.at-shfs-medium .at-icon{margin:6px;width:28px;height:28px}.at-custom-mobile-bar.at-shfs-small{height:40px}.at-custom-mobile-bar.at-shfs-small .at-custom-mobile-bar-counter{margin-top:3px}.at-custom-mobile-bar.at-shfs-small .at-custom-mobile-bar-count{font-size:1pc}.at-custom-mobile-bar.at-shfs-small .at-custom-mobile-bar-text{font-size:10px}.at-custom-mobile-bar.at-shfs-small .at-icon-wrapper{height:2pc;width:2pc}.at-custom-mobile-bar.at-shfs-small .at-icon{margin:4px;width:24px;height:24px}</style><style type="text/css">.at-custom-sidebar{top:20%;width:58px;position:fixed;text-align:center;z-index:100020;background:#fff;overflow:hidden;box-shadow:0 0 10px 0 rgba(0,0,0,.2);font:initial;line-height:normal;top:auto;bottom:0}.at-custom-sidebar.at-custom-sidebar-zindex-hide{z-index:-1!important}.at-custom-sidebar.atss-left{left:0;right:auto;float:left;border-radius:0 4px 4px 0}.at-custom-sidebar.atss-right{left:auto;right:0;float:right;border-radius:4px 0 0 4px}.at-custom-sidebar .at-custom-sidebar-btns{display:inline-block;text-align:center;padding-top:4px}.at-custom-sidebar .at-custom-sidebar-counter{margin-bottom:8px}.at-custom-sidebar .at-share-btn{display:inline-block;text-decoration:none;-webkit-transition:none;transition:none;box-sizing:content-box}.at-custom-sidebar .at-custom-sidebar-counter{font-family:Helvetica neue,arial;vertical-align:top;margin-left:4px;margin-right:4px;display:inline-block}.at-custom-sidebar .at-custom-sidebar-count{font-size:21px;line-height:1.25em;color:#222}.at-custom-sidebar .at-custom-sidebar-text{font-size:10px;line-height:1.25em;color:#888;letter-spacing:1px}.at-custom-sidebar .at-icon-wrapper{text-align:center;margin:0 4px}.at-custom-sidebar .at-icon{vertical-align:top;margin:9px;width:2pc;height:2pc}.at-custom-sidebar .at-icon-wrapper{position:relative}.at-custom-sidebar .at4-share-count,.at-custom-sidebar .at4-share-count-container{line-height:1pc;font-size:10px}.at-custom-sidebar .at4-share-count{text-indent:0;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-weight:200;width:100%;height:1pc}.at-custom-sidebar .at4-share-count-anchor .at-icon{margin-top:3px}.at-custom-sidebar .at4-share-count-container{position:absolute;left:0;right:auto;top:auto;bottom:0;width:100%;color:#fff;background:inherit}</style><style type="text/css">.at-image-sharing-mobile-icon{position:absolute;background:#000 url(//s7.addthis.com/static/44a36d35bafef33aa9455b7d3039a771.png) no-repeat top center;background-color:rgba(0,0,0,.9);background-image:url(//s7.addthis.com/static/10db525181ee0bbe1a515001be1c7818.svg),none;border-radius:3px;width:50px;height:40px;top:-9999px;left:-9999px}.at-image-sharing-tool{display:block;position:absolute;text-align:center;z-index:9001;background:none;overflow:hidden;top:-9999px;left:-9999px;font:initial;line-height:0}.at-image-sharing-tool.addthis-animated{-webkit-animation-duration:.15s;animation-duration:.15s}.at-image-sharing-tool.at-orientation-vertical .at-share-btn{display:block}.at-image-sharing-tool.at-orientation-horizontal .at-share-btn{display:inline-block}.at-image-sharing-tool.at-image-sharing-tool-size-big .at-icon{width:43px;height:43px}.at-image-sharing-tool.at-image-sharing-tool-size-mobile .at-share-btn{margin:0!important}.at-image-sharing-tool.at-image-sharing-tool-size-mobile .at-icon-wrapper{height:60px;width:100%;border-radius:0!important}.at-image-sharing-tool.at-image-sharing-tool-size-mobile .at-icon{max-width:100%;height:54px!important;width:54px!important}.at-image-sharing-tool .at-custom-shape.at-image-sharing-tool-btns{margin-right:8px;margin-bottom:8px}.at-image-sharing-tool .at-custom-shape .at-share-btn{margin-top:8px;margin-left:8px}.at-image-sharing-tool .at-share-btn{line-height:0;text-decoration:none;-webkit-transition:none;transition:none;box-sizing:content-box}.at-image-sharing-tool .at-icon-wrapper{text-align:center;height:100%;width:100%}.at-image-sharing-tool .at-icon{vertical-align:top;width:2pc;height:2pc;margin:3px}</style><style type="text/css">.at-expanding-share-button{box-sizing:border-box;position:fixed;z-index:9999}.at-expanding-share-button[data-position=bottom-right]{bottom:10px;right:10px}.at-expanding-share-button[data-position=bottom-right] .at-expanding-share-button-toggle-bg,.at-expanding-share-button[data-position=bottom-right] .at-expanding-share-button-toggle-btn[data-name]:after,.at-expanding-share-button[data-position=bottom-right] .at-icon-wrapper,.at-expanding-share-button[data-position=bottom-right] [data-name]:after{float:right}.at-expanding-share-button[data-position=bottom-right] [data-name]:after{margin-right:10px}.at-expanding-share-button[data-position=bottom-right] .at-expanding-share-button-toggle-btn[data-name]:after{margin-right:5px}.at-expanding-share-button[data-position=bottom-right] .at-icon-wrapper{margin-right:-3px}.at-expanding-share-button[data-position=bottom-left]{bottom:10px;left:10px}.at-expanding-share-button[data-position=bottom-left] .at-expanding-share-button-toggle-bg,.at-expanding-share-button[data-position=bottom-left] .at-expanding-share-button-toggle-btn[data-name]:after,.at-expanding-share-button[data-position=bottom-left] .at-icon-wrapper,.at-expanding-share-button[data-position=bottom-left] [data-name]:after{float:left}.at-expanding-share-button[data-position=bottom-left] [data-name]:after{margin-left:10px}.at-expanding-share-button[data-position=bottom-left] .at-expanding-share-button-toggle-btn[data-name]:after{margin-left:5px}.at-expanding-share-button *,.at-expanding-share-button :after,.at-expanding-share-button :before{box-sizing:border-box}.at-expanding-share-button .at-expanding-share-button-services-list{display:none;list-style:none;margin:0 5px;overflow:visible;padding:0}.at-expanding-share-button .at-expanding-share-button-services-list>li{display:block;height:45px;position:relative;overflow:visible}.at-expanding-share-button .at-expanding-share-button-toggle-btn,.at-expanding-share-button .at-share-btn{-webkit-transition:.1s;transition:.1s;text-decoration:none}.at-expanding-share-button .at-share-btn{display:block;height:40px;padding:0 3px 0 0}.at-expanding-share-button .at-expanding-share-button-toggle-btn{position:relative;overflow:auto}.at-expanding-share-button .at-expanding-share-button-toggle-btn.at-expanding-share-button-hidden[data-name]:after{display:none}.at-expanding-share-button .at-expanding-share-button-toggle-bg{box-shadow:0 2px 4px 0 rgba(0,0,0,.3);border-radius:50%;position:relative}.at-expanding-share-button .at-expanding-share-button-toggle-bg>span{background-image:url("data:image/svg+xml,%3Csvg%20width%3D%2232px%22%20height%3D%2232px%22%20viewBox%3D%220%200%2032%2032%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Ctitle%3Eshare%3C%2Ftitle%3E%3Cg%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20fill%3D%22%23FFFFFF%22%3E%3Cpath%20d%3D%22M26%2C13.4285714%20C26%2C13.6220248%2025.9293162%2C13.7894338%2025.7879464%2C13.9308036%20L20.0736607%2C19.6450893%20C19.932291%2C19.786459%2019.7648819%2C19.8571429%2019.5714286%2C19.8571429%20C19.3779752%2C19.8571429%2019.2105662%2C19.786459%2019.0691964%2C19.6450893%20C18.9278267%2C19.5037195%2018.8571429%2C19.3363105%2018.8571429%2C19.1428571%20L18.8571429%2C16.2857143%20L16.3571429%2C16.2857143%20C15.6279725%2C16.2857143%2014.9750773%2C16.3080355%2014.3984375%2C16.3526786%20C13.8217977%2C16.3973217%2013.2488868%2C16.477306%2012.6796875%2C16.5926339%20C12.1104882%2C16.7079619%2011.6157015%2C16.8660704%2011.1953125%2C17.0669643%20C10.7749235%2C17.2678581%2010.3824423%2C17.5264121%2010.0178571%2C17.8426339%20C9.65327199%2C18.1588557%209.35565592%2C18.534596%209.125%2C18.9698661%20C8.89434408%2C19.4051361%208.71391434%2C19.9203839%208.58370536%2C20.515625%20C8.45349637%2C21.1108661%208.38839286%2C21.7842224%208.38839286%2C22.5357143%20C8.38839286%2C22.9449425%208.40699386%2C23.4025272%208.44419643%2C23.9084821%20C8.44419643%2C23.9531252%208.45349693%2C24.0405499%208.47209821%2C24.1707589%20C8.4906995%2C24.3009679%208.5%2C24.3995532%208.5%2C24.4665179%20C8.5%2C24.5781256%208.46837829%2C24.6711306%208.40513393%2C24.7455357%20C8.34188956%2C24.8199408%208.25446484%2C24.8571429%208.14285714%2C24.8571429%20C8.02380893%2C24.8571429%207.9196433%2C24.7938994%207.83035714%2C24.6674107%20C7.77827355%2C24.6004461%207.72991094%2C24.5186017%207.68526786%2C24.421875%20C7.64062478%2C24.3251483%207.59040206%2C24.2135423%207.53459821%2C24.0870536%20C7.47879436%2C23.9605648%207.43973225%2C23.87128%207.41741071%2C23.8191964%20C6.47246551%2C21.6986501%206%2C20.0208395%206%2C18.7857143%20C6%2C17.3050521%206.19717065%2C16.0662252%206.59151786%2C15.0691964%20C7.79688103%2C12.0706695%2011.0520568%2C10.5714286%2016.3571429%2C10.5714286%20L18.8571429%2C10.5714286%20L18.8571429%2C7.71428571%20C18.8571429%2C7.52083237%2018.9278267%2C7.35342333%2019.0691964%2C7.21205357%20C19.2105662%2C7.07068382%2019.3779752%2C7%2019.5714286%2C7%20C19.7648819%2C7%2019.932291%2C7.07068382%2020.0736607%2C7.21205357%20L25.7879464%2C12.9263393%20C25.9293162%2C13.067709%2026%2C13.2351181%2026%2C13.4285714%20L26%2C13.4285714%20Z%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");background-position:center center;background-repeat:no-repeat;-webkit-transition:transform .4s ease;transition:transform .4s ease;border-radius:50%;display:block}.at-expanding-share-button .at-icon-wrapper{box-shadow:0 2px 4px 0 rgba(0,0,0,.3);border-radius:50%;display:inline-block;height:40px;line-height:40px;text-align:center;width:40px}.at-expanding-share-button .at-icon{display:inline-block;height:34px;margin:3px 0;vertical-align:top;width:34px}.at-expanding-share-button [data-name]:after{box-shadow:0 2px 4px 0 rgba(0,0,0,.3);-webkit-transform:translate(0, -50%);transform:translate(0, -50%);-webkit-transition:.4s;transition:.4s;background-color:#fff;border-radius:3px;color:#666;content:attr(data-name);font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:9pt;line-height:9pt;font-weight:500;opacity:0;padding:3px 5px;position:relative;top:20px;white-space:nowrap}.at-expanding-share-button.at-expanding-share-button-show-icons .at-expanding-share-button-services-list{display:block}.at-expanding-share-button.at-expanding-share-button-animate-in .at-expanding-share-button-toggle-bg>span{-webkit-transform:rotate(270deg);transform:rotate(270deg);background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20viewBox%3D%220%200%2032%2032%22%3E%3Cg%3E%3Cpath%20d%3D%22M18%2014V8h-4v6H8v4h6v6h4v-6h6v-4h-6z%22%20fill-rule%3D%22evenodd%22%20fill%3D%22white%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E");background-position:center center;background-repeat:no-repeat}.at-expanding-share-button.at-expanding-share-button-animate-in [data-name]:after{opacity:1}.at-expanding-share-button.at-hide-label [data-name]:after{display:none}.at-expanding-share-button.at-expanding-share-button-desktop .at-expanding-share-button-toggle{height:50px}.at-expanding-share-button.at-expanding-share-button-desktop .at-icon-wrapper:hover{box-shadow:0 2px 5px 0 rgba(0,0,0,.5)}.at-expanding-share-button.at-expanding-share-button-desktop .at-expanding-share-button-toggle-bg{height:50px;line-height:50px;width:50px}.at-expanding-share-button.at-expanding-share-button-desktop .at-expanding-share-button-toggle-bg>span{height:50px;width:50px}.at-expanding-share-button.at-expanding-share-button-desktop .at-expanding-share-button-toggle-bg:after{box-shadow:0 2px 5px 0 rgba(0,0,0,.2);-webkit-transition:opacity .2s ease;transition:opacity .2s ease;border-radius:50%;content:'';height:100%;opacity:0;position:absolute;top:0;left:0;width:100%}.at-expanding-share-button.at-expanding-share-button-desktop .at-expanding-share-button-toggle-bg:hover:after{opacity:1}.at-expanding-share-button.at-expanding-share-button-desktop .at-expanding-share-button-toggle-btn[data-name]:after{top:25px}.at-expanding-share-button.at-expanding-share-button-mobile .at-expanding-share-button-services-list{margin:0}.at-expanding-share-button.at-expanding-share-button-mobile .at-expanding-share-button-toggle-btn,.at-expanding-share-button.at-expanding-share-button-mobile .at-share-btn{outline:0}.at-expanding-share-button.at-expanding-share-button-mobile .at-expanding-share-button-toggle{height:40px;-webkit-tap-highlight-color:transparent}.at-expanding-share-button.at-expanding-share-button-mobile .at-expanding-share-button-toggle-bg,.at-expanding-share-button.at-expanding-share-button-mobile .at-expanding-share-button-toggle-bg span{height:40px;line-height:40px;width:40px}.at-expanding-share-button.at-expanding-share-button-mobile .at-expanding-share-button-click-flash{-webkit-transform:scale(0);transform:scale(0);-webkit-transition:transform ease,opacity ease-in;transition:transform ease,opacity ease-in;background-color:hsla(0,0%,100%,.3);border-radius:50%;height:40px;opacity:1;position:absolute;width:40px;z-index:10000}.at-expanding-share-button.at-expanding-share-button-mobile .at-expanding-share-button-click-flash.at-expanding-share-button-click-flash-animate{-webkit-transform:scale(1);transform:scale(1);opacity:0}.at-expanding-share-button.at-expanding-share-button-mobile+.at-expanding-share-button-mobile-overlay{-webkit-transition:opacity ease;transition:opacity ease;bottom:0;background-color:hsla(0,0%,87%,.7);display:block;height:auto;left:0;opacity:0;position:fixed;right:0;top:0;width:auto;z-index:9998}.at-expanding-share-button.at-expanding-share-button-mobile+.at-expanding-share-button-mobile-overlay.at-expanding-share-button-hidden{height:0;width:0;z-index:-10000}.at-expanding-share-button.at-expanding-share-button-mobile.at-expanding-share-button-animate-in+.at-expanding-share-button-mobile-overlay{-webkit-transition:opacity ease;transition:opacity ease;opacity:1}</style><style type="text/css">#addthissmartlayerscssready{color:#bada55!important}.addthis-smartlayers,div#at4-follow,div#at4-share,div#at4-thankyou,div#at4-whatsnext{padding:0;margin:0}#at4-follow-label,#at4-share-label,#at4-whatsnext-label,.at4-recommended-label.hidden{padding:0;border:none;background:none;position:absolute;top:0;left:0;height:0;width:0;overflow:hidden;text-indent:-9999em}.addthis-smartlayers .at4-arrow:hover{cursor:pointer}.addthis-smartlayers .at4-arrow:after,.addthis-smartlayers .at4-arrow:before{content:none}a.at4-logo{background:url(data:image/gif;base64,R0lGODlhBwAHAJEAAP9uQf///wAAAAAAACH5BAkKAAIALAAAAAAHAAcAAAILFH6Ge8EBH2MKiQIAOw==) no-repeat left center}.at4-minimal a.at4-logo{background:url(data:image/gif;base64,R0lGODlhBwAHAJEAAP9uQf///wAAAAAAACH5BAkKAAIALAAAAAAHAAcAAAILFH6Ge8EBH2MKiQIAOw==) no-repeat left center!important}button.at4-closebutton{position:absolute;top:0;right:0;padding:0;margin-right:10px;cursor:pointer;background:transparent;border:0;-webkit-appearance:none;font-size:19px;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:.2}button.at4-closebutton:hover{color:#000;text-decoration:none;cursor:pointer;opacity:.5}div.at4-arrow{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAoCAYAAABpYH0BAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAV1JREFUeNrsmesOgyAMhQfxwfrofTM3E10ME2i5Oeppwr9a5OMUCrh1XV+wcvNAAIAA+BiAzrmtUWln27dbjEcC3AdODfo0BdEPhmcO4nIDvDNELi2jggk4/k8dT7skfeKzWIEd4VUpMQKvNB7X+OZSmAZkATWC1xvipbpnLmOosbJZC08CkAeA4E6qFUEMwLAGnlSBPCE8lW8CYnZTcimH2HoT7kSFOx5HBmCnDhTIu1p5s98G+QZrxGPhZVMY1vgyAQaAAAiAAAgDQACcBOD+BvJtBWfRy7NpJK5tBe4FNzXokywV734wPHMQlxvgnSGyNoUP/2ACjv/7iSeYKO3YWKzAjvCqlBiBVxqPa3ynexNJwOsN8TJbzL6JNIYYXWpMv4lIIAZgWANPqkCeEJ7KNwExu8lpLlSpAVQarO77TyKdBsyRPuwV0h0gmoGnTWFYzVkYBoAA+I/2FmAAt6+b5XM9mFkAAAAASUVORK5CYII=);background-repeat:no-repeat;width:20px;height:20px;margin:0;padding:0;overflow:hidden;text-indent:-9999em;text-align:left;cursor:pointer}#at4-recommendedpanel-outer-container .at4-arrow.at-right,div.at4-arrow.at-right{background-position:-20px 0}#at4-recommendedpanel-outer-container .at4-arrow.at-left,div.at4-arrow.at-left{background-position:0 0}div.at4-arrow.at-down{background-position:-60px 0}div.at4-arrow.at-up{background-position:-40px 0}.ats-dark div.at4-arrow.at-right{background-position:-20px -20px}.ats-dark div.at4-arrow.at-left{background-position:0 -20px}.ats-dark div.at4-arrow.at-down{background-position:-60px -20px}.ats-dark div.at4-arrow.at-up{background-position:-40px -20}.at4-opacity-hidden{opacity:0!important}.at4-opacity-visible{opacity:1!important}.at4-visually-hidden{position:absolute;clip:rect(1px,1px,1px,1px);padding:0;border:0;overflow:hidden}.at4-hidden-off-screen,.at4-hidden-off-screen *{position:absolute!important;top:-9999px!important;left:-9999px!important}.at4-show{display:block!important;opacity:1!important}.at4-show-content{opacity:1!important;visibility:visible}.at4-hide{display:none!important;opacity:0!important}.at4-hide-content{opacity:0!important;visibility:hidden}.at4-visible{display:block!important;opacity:0!important}.at-wordpress-hide{display:none!important;opacity:0!important}.addthis-animated{-webkit-animation-fill-mode:both;animation-fill-mode:both;animation-timing-function:ease-out;-webkit-animation-duration:.3s;animation-duration:.3s}.slideInDown.addthis-animated,.slideInLeft.addthis-animated,.slideInRight.addthis-animated,.slideInUp.addthis-animated,.slideOutDown.addthis-animated,.slideOutLeft.addthis-animated,.slideOutRight.addthis-animated,.slideOutUp.addthis-animated{-webkit-animation-duration:.4s;animation-duration:.4s}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.fadeIn{-webkit-animation-name:fadeIn;animation-name:fadeIn}@-webkit-keyframes fadeInUp{0%{opacity:0;-webkit-transform:translateY(20px)}to{opacity:1;-webkit-transform:translateY(0)}}@keyframes fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.fadeInUp{-webkit-animation-name:fadeInUp;animation-name:fadeInUp}@-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translateY(-20px)}to{opacity:1;-webkit-transform:translateY(0)}}@keyframes fadeInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.fadeInDown{-webkit-animation-name:fadeInDown;animation-name:fadeInDown}@-webkit-keyframes fadeInLeft{0%{opacity:0;-webkit-transform:translateX(-20px)}to{opacity:1;-webkit-transform:translateX(0)}}@keyframes fadeInLeft{0%{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}.fadeInLeft{-webkit-animation-name:fadeInLeft;animation-name:fadeInLeft}@-webkit-keyframes fadeInRight{0%{opacity:0;-webkit-transform:translateX(20px)}to{opacity:1;-webkit-transform:translateX(0)}}@keyframes fadeInRight{0%{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}.fadeInRight{-webkit-animation-name:fadeInRight;animation-name:fadeInRight}@-webkit-keyframes fadeOut{0%{opacity:1}to{opacity:0}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}.fadeOut{-webkit-animation-name:fadeOut;animation-name:fadeOut}@-webkit-keyframes fadeOutUp{0%{opacity:1;-webkit-transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(-20px)}}@keyframes fadeOutUp{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-20px)}}.fadeOutUp{-webkit-animation-name:fadeOutUp;animation-name:fadeOutUp}@-webkit-keyframes fadeOutDown{0%{opacity:1;-webkit-transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(20px)}}@keyframes fadeOutDown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(20px)}}.fadeOutDown{-webkit-animation-name:fadeOutDown;animation-name:fadeOutDown}@-webkit-keyframes fadeOutLeft{0%{opacity:1;-webkit-transform:translateX(0)}to{opacity:0;-webkit-transform:translateX(-20px)}}@keyframes fadeOutLeft{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(-20px)}}.fadeOutLeft{-webkit-animation-name:fadeOutLeft;animation-name:fadeOutLeft}@-webkit-keyframes fadeOutRight{0%{opacity:1;-webkit-transform:translateX(0)}to{opacity:0;-webkit-transform:translateX(20px)}}@keyframes fadeOutRight{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(20px)}}.fadeOutRight{-webkit-animation-name:fadeOutRight;animation-name:fadeOutRight}@-webkit-keyframes slideInUp{0%{-webkit-transform:translateY(1500px)}0%,to{opacity:1}to{-webkit-transform:translateY(0)}}@keyframes slideInUp{0%{transform:translateY(1500px)}0%,to{opacity:1}to{transform:translateY(0)}}.slideInUp{-webkit-animation-name:slideInUp;animation-name:slideInUp}.slideInUp.addthis-animated{-webkit-animation-duration:.4s;animation-duration:.4s}@-webkit-keyframes slideInDown{0%{-webkit-transform:translateY(-850px)}0%,to{opacity:1}to{-webkit-transform:translateY(0)}}@keyframes slideInDown{0%{transform:translateY(-850px)}0%,to{opacity:1}to{transform:translateY(0)}}.slideInDown{-webkit-animation-name:slideInDown;animation-name:slideInDown}@-webkit-keyframes slideOutUp{0%{-webkit-transform:translateY(0)}0%,to{opacity:1}to{-webkit-transform:translateY(-250px)}}@keyframes slideOutUp{0%{transform:translateY(0)}0%,to{opacity:1}to{transform:translateY(-250px)}}.slideOutUp{-webkit-animation-name:slideOutUp;animation-name:slideOutUp}@-webkit-keyframes slideOutUpFast{0%{-webkit-transform:translateY(0)}0%,to{opacity:1}to{-webkit-transform:translateY(-1250px)}}@keyframes slideOutUpFast{0%{transform:translateY(0)}0%,to{opacity:1}to{transform:translateY(-1250px)}}#at4m-menu.slideOutUp{-webkit-animation-name:slideOutUpFast;animation-name:slideOutUpFast}@-webkit-keyframes slideOutDown{0%{-webkit-transform:translateY(0)}0%,to{opacity:1}to{-webkit-transform:translateY(350px)}}@keyframes slideOutDown{0%{transform:translateY(0)}0%,to{opacity:1}to{transform:translateY(350px)}}.slideOutDown{-webkit-animation-name:slideOutDown;animation-name:slideOutDown}@-webkit-keyframes slideOutDownFast{0%{-webkit-transform:translateY(0)}0%,to{opacity:1}to{-webkit-transform:translateY(1250px)}}@keyframes slideOutDownFast{0%{transform:translateY(0)}0%,to{opacity:1}to{transform:translateY(1250px)}}#at4m-menu.slideOutDown{-webkit-animation-name:slideOutDownFast;animation-name:slideOutDownFast}@-webkit-keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-850px);transform:translateX(-850px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-850px);transform:translateX(-850px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}.slideInLeft{-webkit-animation-name:slideInLeft;animation-name:slideInLeft}@-webkit-keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(1250px);transform:translateX(1250px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(1250px);transform:translateX(1250px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}.slideInRight{-webkit-animation-name:slideInRight;animation-name:slideInRight}@-webkit-keyframes slideOutLeft{0%{-webkit-transform:translateX(0);transform:translateX(0)}to{opacity:0;-webkit-transform:translateX(-250px);transform:translateX(-250px)}}@keyframes slideOutLeft{0%{-webkit-transform:translateX(0);transform:translateX(0)}to{opacity:0;-webkit-transform:translateX(-350px);transform:translateX(-350px)}}.slideOutLeft{-webkit-animation-name:slideOutLeft;animation-name:slideOutLeft}@-webkit-keyframes slideOutRight{0%{-webkit-transform:translateX(0);transform:translateX(0)}to{opacity:0;-webkit-transform:translateX(350px);transform:translateX(350px)}}@keyframes slideOutRight{0%{-webkit-transform:translateX(0);transform:translateX(0)}to{opacity:0;-webkit-transform:translateX(350px);transform:translateX(350px)}}.slideOutRight{-webkit-animation-name:slideOutRight;animation-name:slideOutRight}.at4win{margin:0 auto;background:#fff;border:1px solid #ebeced;width:25pc;box-shadow:0 0 10px rgba(0,0,0,.3);border-radius:8px;font-family:helvetica neue,helvetica,arial,sans-serif;text-align:left;z-index:9999}.at4win .at4win-header{position:relative;border-bottom:1px solid #f2f2f2;background:#fff;height:49px;-webkit-border-top-left-radius:8px;-webkit-border-top-right-radius:8px;-moz-border-radius-topleft:8px;-moz-border-radius-topright:8px;border-top-left-radius:8px;border-top-right-radius:8px;cursor:default}.at4win .at4win-header .at-h3,.at4win .at4win-header h3{height:49px;line-height:49px;margin:0 50px 0 0;padding:1px 0 0;margin-left:20px;font-family:helvetica neue,helvetica,arial,sans-serif;font-size:1pc;font-weight:700;text-shadow:0 1px #fff;color:#333}.at4win .at4win-header .at-h3 img,.at4win .at4win-header h3 img{display:inline-block;margin-right:4px}.at4win .at4win-header .at4-close{display:block;position:absolute;top:0;right:0;background:url("data:image/gif;base64,R0lGODlhFAAUAIABAAAAAP///yH5BAEAAAEALAAAAAAUABQAAAIzBIKpG+YMm5Enpodw1HlCfnkKOIqU1VXk55goVb2hi7Y0q95lfG70uurNaqLgTviyyUoFADs=") no-repeat center center;background-repeat:no-repeat;background-position:center center;border-left:1px solid #d2d2d1;width:49px;height:49px;line-height:49px;overflow:hidden;text-indent:-9999px;text-shadow:none;cursor:pointer;opacity:.5;border:0;-webkit-transition:opacity .15s ease-in;transition:opacity .15s ease-in}.at4win .at4win-header .at4-close::-moz-focus-inner{border:0;padding:0}.at4win .at4win-header .at4-close:hover{opacity:1;background-color:#ebeced;border-top-right-radius:7px}.at4win .at4win-content{position:relative;background:#fff;min-height:220px}#at4win-footer{position:relative;background:#fff;border-top:1px solid #d2d2d1;-webkit-border-bottom-right-radius:8px;-webkit-border-bottom-left-radius:8px;-moz-border-radius-bottomright:8px;-moz-border-radius-bottomleft:8px;border-bottom-right-radius:8px;border-bottom-left-radius:8px;height:11px;line-height:11px;padding:5px 20px;font-size:11px;color:#666;-ms-box-sizing:content-box;-o-box-sizing:content-box;box-sizing:content-box}#at4win-footer a{margin-right:10px;text-decoration:none;color:#666}#at4win-footer a:hover{text-decoration:none;color:#000}#at4win-footer a.at4-logo{top:5px;padding-left:10px}#at4win-footer a.at4-privacy{position:absolute;top:5px;right:10px;padding-right:14px}.at4win.ats-dark{border-color:#555;box-shadow:none}.at4win.ats-dark .at4win-header{background:#1b1b1b;-webkit-border-top-left-radius:6px;-webkit-border-top-right-radius:6px;-moz-border-radius-topleft:6px;-moz-border-radius-topright:6px;border-top-left-radius:6px;border-top-right-radius:6px}.at4win.ats-dark .at4win-header .at4-close{background:url("data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAWdEVYdENyZWF0aW9uIFRpbWUAMTEvMTMvMTKswDp5AAAAd0lEQVQ4jb2VQRLAIAgDE///Z3qqY1FAhalHMCsCIkVEAIAkkVgvp2lDBgYAnAyHkWotLccNrEd4A7X2TqIdqLfnWBAdaF5rJdyJfjtPH5GT37CaGhoVq3nOm/XflUuLUto2pY1d+vRKh0Pp+MrAVtDe2JkvYNQ+jVSEEFmOkggAAAAASUVORK5CYII=") no-repeat center center;background-image:url(//s7.addthis.com/static/fb08f6d50887bd0caacc86a62bcdcf68.svg),none;border-color:#333}.at4win.ats-dark .at4win-header .at4-close:hover{background-color:#000}.at4win.ats-dark .at4win-header .at-h3,.at4win.ats-dark .at4win-header h3{color:#fff;text-shadow:0 1px #000}.at4win.ats-gray .at4win-header{background:#fff;border-color:#d2d2d1;-webkit-border-top-left-radius:6px;-webkit-border-top-right-radius:6px;-moz-border-radius-topleft:6px;-moz-border-radius-topright:6px;border-top-left-radius:6px;border-top-right-radius:6px}.at4win.ats-gray .at4win-header a.at4-close{border-color:#d2d2d1}.at4win.ats-gray .at4win-header a.at4-close:hover{background-color:#ebeced}.at4win.ats-gray #at4win-footer{border-color:#ebeced}.at4win .clear{clear:both}.at4win ::selection{background:#fe6d4c;color:#fff}.at4win ::-moz-selection{background:#fe6d4c;color:#fff}.at4-icon-fw{display:inline-block;background-repeat:no-repeat;background-position:0 0;margin:0 5px 0 0;overflow:hidden;text-indent:-9999em;cursor:pointer;padding:0;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%}.at44-follow-container a.aticon{height:2pc;margin:0 5px 5px 0}.at44-follow-container .at4-icon-fw{margin:0}</style><script type="text/javascript" charset="utf-8" async="" src="./Z algorithm _ Ivan Yurchenko_files/counter.ebd6529a0d941007101f.js.download"></script><style type="text/css">.addthis_counter{font-weight:700;display:inline-block;border:0;outline:0;cursor:pointer;color:#fff}.addthis_counter a{display:block;font-family:arial,helvetica,sans-serif!important;text-decoration:none!important;border:0}.addthis_counter{text-decoration:none!important;text-align:left}.addthis_counter .addthis_button_expanded{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAACaCAMAAADcrusAAAAA21BMVEX////+bUznWjrnWjrBwcGJiYnm5ubFxcWMjIyRkZH39/f19fX////nWjr+bUzys6n+uq7/7+z87evqd2H+hm3/5+P+sKPxqJz65OH/9/b+el3paU//zcT2yMDshXH99vX+kXz+nIn/w7n0vrX30cz9bEv/3tn529f/1s/ukYH3aUn+ppbvnY/bUjTmWTn/3dX+9fP3aEj/9vT52NH/5d/aUTP9a0r74tzlWDjfWz386+f/7en4b1H/7uv4b1D/3db/9/X/7uraUjT+9vT87Oj87OnpZEb52dH+dlezszuQAAAABHRSTlMAExMAzBw6IQAAAnlJREFUeF6009eKKzEMBuBJriW5T2/pPdvbqb28/xMdGbOQiyxZZ9n/QnjAH8KWJxl8uqeI3H8ZJFcUmatkFktmCUXnXHIBIRevJ/AcBuUSQI0onZ8k1/QxkNqVJIvyNPl8S1/ZMFkuuYxtqhQoS2MA1RNIGKUArjwk/4Lk0jtXp0QpjEjJHiw5SbzZQlo6eUi+fafba0985LKwqSOqJdNaMdmQ5O+NOn6WYsNlPk7nnvRF6iF3lOBz/MZqZ6kvZCBS+bUn1h/MvTCXmumYArEKijlYJr6N6t8y/fcn5zz+dfwvNlhH9ZmtB8nw6REj8vg0TO4wMnfJPpbsE4zOueQGQm5eT+A5DKopgF5htjhJLvFDIE1eoeiq0+T3A/5lw2Q65TIxmdagDU4AdIsgYJUB5NUh+RMklzbPmwwxgxVq0YLBXCBvNpBVuTgkP3/hw6UnPmLamSxHbATTRjPZouDvrT5+lm7LZTHJFp60XeYhdxTgc/zGmtxg24lAhPZrT4w/WP7CXBqmEwzEaOgWYJj4Nrp9y/Tfn5zz+Hex5Ecy3EX12e+G/9mrQxUAYBgGooEFAm3//3snZmviJnL+6cMRrXSgHqsWOGb8iISEhISEqDxRAsSld5De/nLbr4MViEEYDMI5mFQ3ff/nXejx33YHcyqtc/8QQSXaRYfJZpAaFWx2FdwfMXyqYdYjp4punpP5fcgiiyyyyCKVl9+6nxQHCP+t20WHCTdIjQo2KjgDAT/Y7UQk/li1tkPtyaQlEhBARABBUV+lvhc1rz4w+FX4bKWLrA0cp7Ue+KhqnpA/mXggAQFEBBAU9VXqe1HzzgNTv2Iyx9Dc8gWOjkKMG1wfQQAAAABJRU5ErkJggg==");background-repeat:no-repeat;display:inline-block}.addthis_counter .atc_s{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUBAMAAAB/pwA+AAAAFVBMVEUAAAD///////////////////////9Iz20EAAAABnRSTlMAwPm7kB4+mBDvAAAAP0lEQVQI12MIVksDgyRTBrM0KEhmAApChRnS4ACdKcCIl5ko6MAiKAZmJjAAARsKE6GAsGE43IBwJLLTER4CAHvvQkc3Hji8AAAAAElFTkSuQmCC");background-size:10px;background-repeat:no-repeat;background-color:#fe6d4c;background-position:5px 5px;display:inline-block;border-radius:2px;min-width:25px;text-decoration:none}.addthis_counter .atc_s:hover{background-color:#e75a3a}.addthis_counter.addthis_bubble_style{background-image:url("data:image/gif;base64,R0lGODlhUgBkAKIEAOrq6sLCwoWFhf///////wAAAAAAAAAAACH5BAEAAAQALAAAAABSAGQAAAP/SLoa/jDKSetkOGsdwPhgKI5kaYpAsK1sd75wPKZsjQVyrpuq7eO7YLDnqwGFyBixuDomn6UlkwOtkqTTm3ULwmYXTi7U+3WJreSp+VxNF9fs8ZcBjz/dRo8dPSfU90l4TXqAcn1/hTuCLYSJQ31gjY45i3mTipB0kpcnlTZhnDyZdKFKo2ClMJ5GqS+rLa2dpw2xorOgtR+vg7kou7y9AzSzYBbGx8gRxAwCzc7P0NHS09TSywoCm60AAsvZwSDcxALgId2z5OUf56fp6uyj7uXwmfLg9JD2wfh9+r38X76pGwBwisCBBYscRFhP2718Dh/OWThwXb+IEidi/New+SKIhD4ozmu3sRVIhSVLnVRYcWXIluNgopPZjmY8m/VwQlQnblxKRz29VRtKtCg0YsmSOsBgtGmzNz9zDCMgEkpQWGyI+KuyElebBVuhdI2jNc5JRF+pRtUBEu3XqlYSum0DNy6jPQHqcrVEVq2ds2spYQssY2xWsGZ/9MWW+NNiqo35cpmqV8jVFkqTMXVqlEnmz1I4i4Y3twplwjqCehVTthC71VxaA3qdSPYe2oVs/0WVG7HrBqgx+f1deouKylsEFDeOPPlyNM3tPpcTXSzw2oMT4QakOzJs475n8+Ye/vZ4vOV30+rN+Pf1PacBXQWdefPopgQSAAA7");background-repeat:no-repeat}.addthis_counter a.atc_s{font-size:11px;font-weight:100;color:#fff;padding:0 5px 0 20px;line-height:20px;overflow:hidden;cursor:pointer;-webkit-transition:none;transition:none}.addthis_counter .atc_s-span,.addthis_counter a.atc_s{display:block;height:20px}.addthis_counter .addthis_button_expanded.at300m .at4-icon{display:none!important}.addthis_counter a.addthis_button_expanded:hover,.addthis_counter.addthis_pill_style a.addthis_button_expanded:hover{text-decoration:none;color:#000}.addthis_counter .addthis_button_expanded{display:block;background-repeat:no-repeat;background-position:0 -40px;width:50px;height:33px;line-height:33px;padding-bottom:4px;margin-bottom:3px;text-align:center;text-decoration:none;font-size:1pc;font-weight:700;color:#333}.addthis_counter{vertical-align:top}.addthis_counter.addthis_native_counter .addthis_button_expanded{font-weight:400}* html .addthis_counter.compatmode0 .addthis_button_expanded{padding-bottom:0!important}* html .addthis_counter .addthis_button_expanded{height:37px}.addthis_counter .addthis_button_expanded:hover{background-position:0 -77px;cursor:pointer;color:#000}.addthis_counter .addthis_button_expanded .at300bs{display:none!important}.addthis_counter.addthis_pill_style{display:block;height:25px;overflow:hidden}.addthis_counter.addthis_pill_style a.atc_s{float:left}.addthis_counter.addthis_pill_style a.addthis_button_expanded{display:none;background-repeat:no-repeat;background-position:0 -114px;width:34px!important;height:20px;line-height:20px;margin:0 0 0 3px;padding:0 0 0 4px;float:left;text-align:center;text-decoration:none;font-family:arial,helvetica,sans-serif;font-weight:700;font-size:11px;color:#333;-ms-box-sizing:content-box;-o-box-sizing:content-box;box-sizing:content-box}.addthis_counter.addthis_pill_style.addthis_nonzero a.addthis_button_expanded{display:block!important;-webkit-transition:none;transition:none}.addthis_counter.addthis_pill_style a.addthis_button_expanded:hover{background-position:0 -134px!important}.addthis_counter.addthis_bubble_style{margin:0 0 0 -2px;text-align:center;font-weight:700;font-family:arial,helvetica,sans-serif;color:#000;background-repeat:no-repeat;background-position:0 -4pc;padding:0 0 0 4px;height:1pc;width:2pc!important;-ms-box-sizing:content-box;-o-box-sizing:content-box;box-sizing:content-box}.addthis_native_counter_parent .addthis_counter.addthis_bubble_style{background-position:0 -4pc!important}.addthis_counter.addthis_bubble_style.addthis_native_counter{margin:0 2px}.addthis_counter.addthis_bubble_style a.addthis_button_expanded{font-size:11px;height:1pc;line-height:1pc;width:34px;background:none}.addthis_counter.addthis_bubble_style:hover{background-position:-36px -4pc!important}.addthis_20x20_style .addthis_counter.addthis_bubble_style{background-repeat:no-repeat;background-position:0 -5pc!important;height:20px;width:35px!important;line-height:20px;padding:0 0 0 6px}.addthis_20x20_style .addthis_counter.addthis_bubble_style:hover{background-position:-41px -5pc!important}.addthis_20x20_style .addthis_counter.addthis_bubble_style a.addthis_button_expanded{background:none;font-size:9pt;line-height:20px;height:20px;margin:0;width:35px!important;padding:0!important}.addthis_20x20_style .addthis_counter.addthis_bubble_style.addthis_native_counter a.addthis_button_expanded{font-size:11px}.addthis_32x32_style .addthis_counter.addthis_bubble_style,.addthis_32x32_white_style .addthis_counter.addthis_bubble_style{background-repeat:no-repeat;background-position:0 0!important;height:2pc;width:56px!important;line-height:2pc;padding:0 0 0 6px}.addthis_32x32_style .addthis_counter.addthis_bubble_style a.addthis_button_expanded,.addthis_32x32_white_style .addthis_counter.addthis_bubble_style a.addthis_button_expanded{background:none;font-size:1pc;line-height:2pc;height:2pc;margin:0;width:56px!important;padding:0!important}.addthis_32x32_style .addthis_counter.addthis_bubble_style:hover,.addthis_32x32_white_style .addthis_counter.addthis_bubble_style:hover{background-position:0 -2pc!important}.addthis_counter.addthis_bubble_style .atc_s{display:none!important}* html .addthis_counter.addthis_bubble_style{width:36px!important;display:inline}* html .addthis_counter.bubblecompatmode0{width:2pc!important;display:block}* html .addthis_counter.addthis_bubble_style a.addthis_button_expanded{width:24px!important;height:14px!important;line-height:14px!important;padding:0;margin-top:1px!important;display:inline}* html .addthis_counter.bubblecompatmode0 a.addthis_button_expanded{width:36px}* html .addthis_32x32_style .addthis_counter.addthis_bubble_style{width:60px!important}* html .addthis_32x32_style .addthis_counter.addthis_bubble_style a.addthis_button_expanded{width:46px;height:26px!important;line-height:26px!important;margin-top:2px!important}* html .addthis_32x32_style .addthis_counter.bubblecompatmode0 a.addthis_button_expanded{height:2pc!important;line-height:2pc!important}</style><script type="text/javascript" charset="utf-8" async="" src="./Z algorithm _ Ivan Yurchenko_files/button.3943c052be33b5e812dac6838df9cb3d.js.download"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head>

<body class="post-template-default single single-post postid-5 single-format-standard">
<div id="page-clip">
	<nav id="mobile-menu" role="navigation">
	<div id="nav-toggle">
		<div class="toggle genericon"></div>
	</div>
		<a class="skip-link screen-reader-text" href="https://ivanyu.me/blog/2013/10/15/z-algorithm/#content">Skip to content</a>
		<div class="menu"><ul>
<li><a href="https://ivanyu.me/"><span>Home</span></a></li><li id="menu-item-13" class="menu-item-13"></li>
</ul></div>
	</nav><!-- #site-navigation -->
	<div id="page-wrap">
				<div class="mobile-header">
			<h1 class="site-title"><a href="https://ivanyu.me/" rel="home">Ivan Yurchenko</a></h1>
		</div>
		<header id="masthead" class="site-header" role="banner">
			<div class="header-wrap">
							<div class="site-branding">
											<h1 class="site-title"><a href="https://ivanyu.me/" rel="home">Ivan Yurchenko</a></h1>
						<h2 class="site-description">Yet another programming blog.</h2>
									</div>

				<nav id="site-navigation" class="main-navigation" role="navigation">
					<a class="skip-link screen-reader-text" href="https://ivanyu.me/blog/2013/10/15/z-algorithm/#content">Skip to content</a>

					<div class="menu"><ul>
<li><a href="https://ivanyu.me/">Home</a></li><li class="menu-item-13"></li>
</ul></div>
				</nav><!-- #site-navigation -->
			</div><!-- .header-wrap -->
		</header><!-- #masthead -->
		<div id="page" class="hfeed site">

		<!-- Hook in your slider/carousel here -->
		
		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-5" class="post-5 post type-post status-publish format-standard hentry category-algorithms category-programming tag-algorithms-2 tag-strings">

	<header class="entry-header">
		<h1 class="entry-title">Z algorithm</h1>
	</header><!-- .entry-header -->
		
	<div class="entry-content">
		<span class="genericon genericon-standard post-format-icon"></span><div class="post-format-content"><!-- AddThis Sharing Buttons above --><div class="at-above-post addthis_default_style addthis_toolbox at-wordpress-hide" data-title="Z algorithm" data-url="https://ivanyu.me/blog/2013/10/15/z-algorithm/"><div class="atclear"></div></div><h3>Introduction</h3>
<p>There are some algorithms of exact substring searching (e.g. <a href="https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm"><dfn>Knuth-Morris-Pratt</dfn></a>, <a href="https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm"><dfn>Boyer-Moore</dfn></a> etc.) I want to explain one of them which is called <strong>Z algorithm</strong> in some sources.</p>
<h3>Z-boxes and Z-values</h3>
<p>Let’s consider the concept of <dfn>Z-box</dfn>. Take the string <code>S = "abcxxxabyyy"</code>. We have an internal part <code>"ab"</code> in the string which repeats its prefix. The internal <code>"ab"</code> is a <strong>Z-box</strong>. It has the beginning at the position with index 6 and the end in 7 (0-based). Z-boxes are substrings which match string prefixes with the same length. For the Z-box, let’s call the corresponding prefix <dfn>the prototype</dfn> (it’s my term but I think it’s OK to use it.)</p>
<p><img class="aligncenter size-full" src="./Z algorithm _ Ivan Yurchenko_files/zalg1.png" alt="Z algorithm" width="391" height="234"></p>
<p><span id="more-5"></span></p>
<p>In fact, the string <code>"abcxxxabyyy"</code> has three non-empty (i.e. with length greater than zero) Z-boxes:<br>
1) the whole strings matches it’s prefix length 11;<br>
2) <code>'a'</code> character at the position 6;<br>
3) just considered substring <code>"ab"</code> (6-7).</p>
<p>Let Z-value, <code>Z<sub>i</sub>(S)</code> or just <code>Z<sub>i</sub></code> be the length of a Z-box in string <code>S</code> which starts at the position <code>i</code>. Obviously, Z-value can’t be bigger than the length of the rest of the string.</p>
<p>We can compute all Z-values in the string:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">c</td>
<td class="ztable">x</td>
<td class="ztable">x</td>
<td class="ztable">x</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable">y</td>
<td class="ztable">y</td>
<td class="ztable">y</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">11</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<p>Z-box [0-10] matches the whole string, so has the length 11. Z-box [6-7] matches prefix [0-1], length 2. Z-box [7-7] matches prefix [0-0], length 1.</p>
<p>Let’s ignore empty Z-boxes (with the length 0).</p>
<p class="small-margin-bottom">Some examples:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">6</td>
<td class="ztable">5</td>
<td class="ztable">4</td>
<td class="ztable">3</td>
<td class="ztable">2</td>
<td class="ztable">1</td>
</tr>
</tbody>
</table>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">b</td>
<td class="ztable">b</td>
<td class="ztable">b</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">6</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">c</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable ztable-zbox">c</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">6</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">r</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable">c</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable">d</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable ztable-zbox">r</td>
<td class="ztable ztable-zbox">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">11</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
</tr>
</tbody>
</table>
<h3>Naïve computation of Z-values</h3>
<p>The naïve algorithm of Z-values computation is very simple: we just need to go through all string indexes starting from 1 and explicitly calculate <code>Z<sub>i</sub>(S)</code>.</p>
<p class="small-margin-bottom">In Python it’d look like:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-58657937b5837555470595" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def z_naive(s):
    Z = [len(s)]

    for k in range(1, len(s)):
        n = 0
        while n + k &lt; len(s) and s[n] == s[n + k]:
            n += 1
        Z.append(n)

    return Z</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-58657937b5837555470595-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5837555470595-2">2</div><div class="crayon-num" data-line="crayon-58657937b5837555470595-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5837555470595-4">4</div><div class="crayon-num" data-line="crayon-58657937b5837555470595-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5837555470595-6">6</div><div class="crayon-num" data-line="crayon-58657937b5837555470595-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5837555470595-8">8</div><div class="crayon-num" data-line="crayon-58657937b5837555470595-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5837555470595-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-58657937b5837555470595-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">z_naive</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5837555470595-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-58657937b5837555470595-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5837555470595-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5837555470595-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5837555470595-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5837555470595-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5837555470595-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-58657937b5837555470595-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5837555470595-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">Z</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>Or you might want some <em>Python magic</em> :)</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-58657937b5853203752005" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Z = [len(list(takewhile(lambda p: p[0] == p[1], zip(s, s[k:]))))
     for k in range(len(s))]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-58657937b5853203752005-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5853203752005-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-58657937b5853203752005-1"><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-e">takewhile</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5853203752005-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>But <a href="http://www.python.org/dev/peps/pep-0020/">simple is better than complex</a>, isn’t it?</p>
<h3>Advanced computation of Z-values</h3>
<p>The naïve implementation has <code>O(|S|<sup>2</sup>)</code> time complexity, where <code>|S|</code> is the length of the string. Can it be better? Yes, it can.</p>
<p>What do we know about Z-box? We know that the corresponding substring is exactly the same as the prefix of the string (with the same length). We compute Z-value sequentially from the beginning, so we could use these previous values.</p>
<p>Introduce indexes <code>lt<sub>i</sub></code> (for “left”) and <code>rt<sub>i</sub></code> (for “right”). <code>rt<sub>i</sub></code> indicates the right-most end (the index of the last character) of any Z-box that starts at the position <code>i</code> or to the left of this position at the position <code>lt<sub>i</sub></code>. In the future we will skip <code>i</code> in <code>lt<sub>i</sub></code> and <code>rt<sub>i</sub></code>. Let’s call Z-box in range <code>[lt..rt]</code> (both ends are included) <strong>the current Z-box</strong>.</p>
<p>For index k inside the current Z-box, let’s call index <code>p=k-lt</code> lying inside the prototype <strong>the pair index</strong>.</p>
<p><img class="aligncenter size-full" src="./Z algorithm _ Ivan Yurchenko_files/zalg2.png" alt="" width="592" height="144"></p>
<p>We know the value of <code>Z<sub>p</sub></code>. Substrings in Z-box and its prototype are equal. Can we say that <code>Z<sub>k</sub> = Z<sub>p</sub></code>? Under some conditions, yes.</p>
<p>The fact that the current character at the position k is inside previously found Z-box can give us some information. Let’s take substring <code>S(k..rt)</code> and consider two cases.</p>
<h4>Case 1</h4>
<p><code>Z<sub>p</sub> &lt; |S(k..rt)|</code>, i.e. <code>Z<sub>p</sub></code> is less then the length of the rest (starting from <code>k</code>) of the current Z-box.<br>
<code>|S(k..rt)| = rt-k+1</code>.<br>
We can add <code>k</code> to the both side of the condition: <code>k+Z<sub>p</sub> &lt; rt+1</code>.</p>
<p>Note: Pay attention that if we have a string with the length <code>n</code> which starts at the position <code>i</code> then the end of the string will be at the position <code>x+i-1</code>. For example, if <code>n=1</code> and <code>i=2</code> then the string begins and ends at the position 2. If <code>i=0</code> and <code>n=2</code> then the string begins in 0 and ends in 1.</p>
<p>In this case, we have two identical substrings (Z-box and its prototype), two identical characters inside them (at k and p positions correspondingly).<br>
Moreover, we have the following information:<br>
1) substrings <code>S(p..p+Z<sub>p</sub>-1)</code> and <code>S(0..Z<sub>p</sub>-1)</code> are identical (from the meaning of <code>Z<sub>p</sub></code>);<br>
2) substrings <code>S(k..k+Z<sub>p</sub>-1)</code> and <code>S(p..p+Z<sub>p</sub>-1)</code> are identical because indexes <code>k</code> and <code>k+Z<sub>p</sub>-1</code>, <code>p</code> and <code>p+Z<sub>p</sub>-1</code> lie inside the Z-box and its prototype at the same relative positions;<br>
3) substrings <code>S(k..k+Z<sub>p</sub>-1)</code> and <code>S(0..Z<sub>p</sub>-1)</code> are identical (from statement 1 and 2);</p>
<p><img class="aligncenter size-full" src="./Z algorithm _ Ivan Yurchenko_files/zalg3.png" alt="" width="544" height="206"></p>
<p>4) characters <code>S(p+Z<sub>p</sub>)</code> and <code>S(Z<sub>p</sub>)</code> aren’t equal (again, from the meaning of <code>Z<sub>p</sub></code>);<br>
5) characters <code>S(k+Z<sub>p</sub>)</code> and <code>S(p+Z<sub>p</sub>)</code> are equal because these indexes lie inside Z-box and its prototype at the same relative positions;<br>
6) characters <code>S(k+Z<sub>p</sub>)</code> and <code>S(Z<sub>p</sub>)</code> aren’t equal (from statement 4 and 5);</p>
<p><img class="aligncenter size-full" src="./Z algorithm _ Ivan Yurchenko_files/zalg4.png" alt="" width="546" height="217"></p>
<p>From statements 3 and 5 and the meaning of <code>Z<sub>k</sub></code> we can conclude that <code>Z<sub>k</sub></code> is equal to <code>Z<sub>p</sub></code>.</p>
<p>Thus we can state that when index <code>k</code> is inside the current Z-box with the left border <code>lt</code>, right border <code>rt</code> and <code>Z<sub>p</sub> &lt; rt-k+1</code> then <code>Z<sub>k</sub> = Z<sub>p</sub></code>, where <code>p=k-lt</code>.</p>
<p><code>lt</code> and <code>rt</code> remain the same because <code>k+Z<sub>k</sub></code> certainly lies to the left of the current <code>rt</code>.</p>
<p>We need the strict condition <code>Z<sub>p</sub> &lt; |S(k..rt)|</code> instead of <code>Z<sub>p</sub> ≤ |S(k..rt)|</code> to be able to say about the equality of characters <code>S(k+Z<sub>p</sub>)</code> and <code>S(p+Z<sub>p</sub>)</code> with confidence. If <code>Z<sub>p</sub> = |S(k..rt)|</code> then <code>S(k+Z<sub>p</sub>)</code> lies outside the current Z-box and we have no idea about either these characters are equal or not. Why don’t we just check? This smoothly brings us to the case 2.</p>
<h4>Case 2</h4>
<p><code>Z<sub>p</sub> &gt; |S(k..rt)|</code>.<br>
<code>|S(k..rt)| = rt-k+1</code>.<br>
In this case we can’t simply state that <code>Z<sub>k</sub> = Z<sub>p</sub></code> because we don’t know anything about equality of characters beyond the right bounds of prototype and Z-box.</p>
<p><img class="aligncenter size-full" src="./Z algorithm _ Ivan Yurchenko_files/zalg5.png" alt="" width="616" height="193"></p>
<p>We know that substrings <code>S(k..k+h)</code>, <code>S(p..p+h)</code> and <code>S(0..h)</code> are identical. We can simply compare characters from ranges <code>[rt+1..|S|]</code> and <code>[rt-k+1..|S|-k]</code> until the first inequality or the end of the ranges (and the whole string). If we found not equal characters at positions <code>q</code> and <code>k+q</code> then <code>Z<sub>k</sub></code> equals the length of the equal substrings, i.e. <code>Z<sub>k</sub> = q</code>.</p>
<p>Of course, we must set the new value to <code>rt</code> and <code>lt</code>, corresponding to the newly found Z-box because <code>k+q-1</code> lies to the right of <code>rt</code> (or at least they are equal).</p>
<p>Obviously, when <code>k</code> isn’t inside the current Z-box (<code>k &gt; rt</code>), we have to calculate <code>Z<sub>k</sub></code> explicitly.</p>
<p>The formalization of the algorithm might look like this:</p>
<p>Having string <code>S</code>,<br>
Set <code>Z<sub>0</sub>=|S|</code>, <code>lt=0</code>, <code>rt=0</code>.<br>
For each <code>k</code>, <code>1 ≤ k &lt; |S|</code> do:<br>
1. If <code>k &gt; rt</code>: calculate <code>Z<sub>k</sub>(S)</code> explicitly. If <code>Z<sub>k</sub> &gt; 0</code>, set <code>lt := k</code> and <code>rt := k+Z<sub>k</sub>-1</code>.<br>
2. Else: <code>p := k-lt</code>.<br>
<span style="margin-left: 2em;">2.1. If <code>Z<sub>p</sub> &lt; rt-k+1</code>, set <code>Z<sub>k</sub> := Z<sub>p</sub></code>.</span><br>
<span style="margin-left: 2em;">2.2. If <code>Z<sub>p</sub> ≥ rt-k+1</code>, for each <code>i</code>, <code>rt+1 ≤ i &lt; |S|</code> do:</span><br>
<span style="margin-left: 4em;">2.2.1. If <code>S(i) = S(i-k)</code>: increment <code>i</code> and continue.</span><br>
<span style="margin-left: 4em;">2.2.2. If <code>S(i) ≠ S(i-k)</code>: set <code>Z<sub>k</sub> := i-k</code>, <code>lt := k</code>, <code>rt := i-1</code> and break.</span></p>
<p>And in Python:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-58657937b585f313627132" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def z_advanced(s):
    """An advanced computation of Z-values of a string."""

    Z = [0] * len(s)
    Z[0] = len(s)

    rt = 0
    lt = 0

    for k in range(1, len(s)):
        if k &gt; rt:
            # If k is outside the current Z-box, do naive computation.
            n = 0
            while n + k &lt; len(s) and s[n] == s[n+k]:
                n += 1
            Z[k] = n
            if n &gt; 0:
                lt = k
                rt = k+n-1
        else:
            # If k is inside the current Z-box, consider two cases.

            p = k - lt  # Pair index.
            right_part_len = rt - k + 1

            if Z[p] &lt; right_part_len:
                Z[k] = Z[p]
            else:
                i = rt + 1
                while i &lt; len(s) and s[i] == s[i - k]:
                    i += 1
                Z[k] = i - k

                lt = k
                rt = i - 1
    return Z</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-58657937b585f313627132-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-2">2</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-4">4</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-6">6</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-8">8</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-10">10</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-12">12</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-14">14</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-16">16</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-18">18</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-20">20</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-22">22</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-24">24</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-26">26</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-28">28</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-30">30</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-32">32</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-34">34</div><div class="crayon-num" data-line="crayon-58657937b585f313627132-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b585f313627132-36">36</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-58657937b585f313627132-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">z_advanced</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"""An advanced computation of Z-values of a string."""</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-6">&nbsp;</div><div class="crayon-line" id="crayon-58657937b585f313627132-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># If k is outside the current Z-box, do naive computation.</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-o">+</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">+</span><span class="crayon-v">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># If k is inside the current Z-box, consider two cases.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-22">&nbsp;</div><div class="crayon-line" id="crayon-58657937b585f313627132-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lt</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># Pair index.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">right_part_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">right_part_len</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-58657937b585f313627132-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b585f313627132-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">Z</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0080 seconds] -->
<p>&nbsp;</p>
<h4>Example</h4>
<p>Let’s consider the example: take the string <code>S = "ababxababyabaca"</code> and calculate Z-values by the described algorithm.<br>
We’ll highlight the current Z-box with the blue color in the “Index” row and matching and non-matching characters of a potential Z-box with the green and the red color respectively in the “Character” row.</p>
<p class="small-margin-bottom"><code>Z<sub>0</sub> = |S| = 15</code>.</p>
<p class="small-margin-bottom">Start from <code>k = 1</code>. <code>lt = 0</code>, <code>rt = 0</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable ztable-mis">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=1 &gt; rt=0</code> and we must calculate <code>Z<sub>1</sub></code> explicitly. <code>S(1) ≠ S(0)</code>, so <code>Z<sub>1</sub> = 0</code>. We don’t treat empty Z-boxes as normal Z-boxes, so we just skip it, no updates of <code>lt</code> and <code>rt</code> are made.</p>
<p class="small-margin-bottom"><code>k = 2</code>, <code>lt = 0</code>, <code>rt = 0</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-mis">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p>Again, <code>k=1 &gt; rt=0</code> and we’re calculating <code>Z<sub>2</sub></code> explicitly. <code>S(2) = S(0)</code>, <code>S(3) = S(1)</code>, <code>S(4) ≠ S(2)</code>, so <code>Z<sub>2</sub> = 2</code>. This is a normal newly found Z-box and we update <code>lt := k = 2</code>, <code>rt := k + Z<sub>k</sub> - 1 = 2 + 2 - 1 = 3</code>.</p>
<p class="small-margin-bottom"><code>k = 3</code>, <code>lt = 2</code>, <code>rt = 3</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p>Here, <code>k=3 ≤ rt=3</code>. It has the pair index <code>p = k-lt = 3-2 = 1</code>. <code>Z<sub>p</sub>=Z<sub>1</sub>=0</code>. <code>Z<sub>1</sub> &lt; rt-k+1=1</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>3</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 4</code>, <code>lt = 2</code>, <code>rt = 3</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-mis">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=4 &gt; rt=3</code> and we’re calculating <code>Z<sub>4</sub></code> explicitly. <code>S(4) ≠ S(0)</code>, so <code>Z<sub>4</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 5</code>, <code>lt = 2</code>, <code>rt = 3</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-mis">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=5 &gt; rt=3</code> and we’re calculating <code>Z<sub>5</sub></code> explicitly. <code>Z<sub>5</sub> = 4</code>. This is a normal newly found Z-box and we update <code>lt := k=5</code>, <code>rt := k+Z<sub>k</sub>-1 = 5+4-1 = 8</code>.</p>
<p class="small-margin-bottom"><code>k = 6</code>, <code>lt = 5</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable ztable-zbox">5</td>
<td class="ztable ztable-zbox">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=6 ≤ rt=8</code>. The pair index <code>p = k-lt = 6-5 = 1</code>. <code>Z<sub>p</sub> = Z<sub>1</sub> = 0</code>. <code>Z<sub>1</sub> &lt; rt-k+1 = 3</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>6</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 7</code>, <code>lt = 5</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable ztable-zbox">5</td>
<td class="ztable ztable-zbox">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-mis">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=7 ≤ rt=8</code>. The pair index <code>p = k-lt = 7-5 = 2</code>. <code>Z<sub>p</sub> = Z<sub>2</sub> = 2</code>. <code>Z<sub>2</sub> ≥ rt-k+1=2</code>, so we need to examine characters starting from <code>rt+1=9</code> and compare them to characters starting from <code>rt+1-k=2</code>. <code>S(9) ≠ S(2)</code>, first not equal characters are at positions 2 and 9. So, <code>Z<sub>7</sub> = 9-k = 2</code>. Also, we need to update <code>lt := k=7</code>, <code>rt := k+Z<sub>k</sub>-1 = 7+2-1 = 8</code>.</p>
<p class="small-margin-bottom"><code>k = 8</code>, <code>lt = 7</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=8 ≤ rt=8</code>. The pair index <code>p = k-lt = 8-7 = 1</code>. <code>Z<sub>p</sub> = Z<sub>1</sub> = 0</code>. <code>Z<sub>1</sub> &lt; rt-k+1 = 1</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>8</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 9</code>, <code>lt = 7</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable ztable-mis">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=9 &gt; rt=8</code> and we’re calculating <code>Z<sub>9</sub></code> explicitly. <code>S(9) ≠ S(0)</code>, so <code>Z<sub>9</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 10</code>, <code>lt = 7</code>, <code>rt = 8</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable ztable-zbox">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-match">b</td>
<td class="ztable ztable-match">a</td>
<td class="ztable ztable-mis">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=10 &gt; rt=8</code> and we’re calculating <code>Z<sub>10</sub></code> explicitly. <code>S(10) = S(0)</code>, <code>S(11) = S(1)</code>, <code>S(12) = S(2)</code>, <code>S(13) ≠ S(3)</code>, so <code>Z<sub>10</sub> = 3</code>. Also, we need to update <code>lt := k=10</code>, <code>rt := k+Z<sub>k</sub>-1 = 10+3-1 = 12</code>.</p>
<p class="small-margin-bottom"><code>k = 11</code>, <code>lt = 10</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable ztable-zbox">10</td>
<td class="ztable ztable-zbox">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=11 ≤ rt=12</code>. The pair index <code>p = k-lt = 11-10 = 1</code>. <code>Z<sub>p</sub> = Z<sub>1</sub> = 0</code>. <code>Z<sub>1</sub> &lt; rt-k+1=2</code>, so we don’t need to examine any additional characters and can say that <code>Z<sub>11</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 12</code>, <code>lt = 10</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable ztable-zbox">10</td>
<td class="ztable ztable-zbox">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable ztable-mis">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable"></td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">p</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=12 ≤ rt=12</code>. The pair index <code>p = k-lt = 12-10 = 2</code>. <code>Z<sub>p</sub>=Z<sub>2</sub>=2 ≥ rt-k+1=1</code>, so we need to examine additional characters starting from <code>rt+1=13</code> and compare them to characters starting from <code>rt+1-k=1</code>. <code>S(13) ≠ S(1)</code>, first not equal characters are at positions 1 and 13. So, <code>Z<sub>12</sub> = 13-k = 1</code>. Also, we need to update <code>lt := k=12</code>, <code>rt := k+Z<sub>k</sub>-1 = 12+1-1 = 12</code>.</p>
<p class="small-margin-bottom"><code>k = 13</code>, <code>lt = 12</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable"></td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt<br>
rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
<td class="ztable ztable-pointer"></td>
</tr>
</tbody>
</table>
<p><code>k=13 &gt; rt=12</code> and we’re calculating <code>Z<sub>13</sub></code> explicitly. <code>S(13) ≠ S(0)</code>, so <code>Z<sub>13</sub> = 0</code>.</p>
<p class="small-margin-bottom"><code>k = 14</code>, <code>lt = 12</code>, <code>rt = 12</code>.</p>
<table class="ztable ztable-pointers">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">lt<br>
rt</td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
</tr>
<tr>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer"></td>
<td class="ztable ztable-pointer">k</td>
</tr>
</tbody>
</table>
<p><code>k=14 &gt; rt=12</code> and we’re calculating <code>Z<sub>14</sub></code> explicitly. <code>S(14) = S(0)</code>, so <code>Z<sub>14</sub> = 1</code>.</p>
<p class="small-margin-bottom">Finally, we have:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable">8</td>
<td class="ztable">9</td>
<td class="ztable">10</td>
<td class="ztable">11</td>
<td class="ztable">12</td>
<td class="ztable">13</td>
<td class="ztable">14</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">y</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">a</td>
<td class="ztable">c</td>
<td class="ztable">a</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">15</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">4</td>
<td class="ztable">0</td>
<td class="ztable">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">3</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
</tr>
</tbody>
</table>
<h4>Complexity</h4>
<p>Let’s find out (not very strictly) time and space complexity of the algorithm. We have <code>|S|</code> iterations. In each iteration we either already have got a Z-value or we have to do some comparisons. When we find <code>q</code> matches during the comparisons <code>rt</code> will be moved to the right: <code>rt<sub>k</sub> := rt<sub>k-1</sub>+q</code>. After each mismatch an iteration finishes, so there aren’t more than <code>|S|</code> mismatches. We have not more than <code>|S|</code> iterations with not more than <code>|S|</code> matches and mismatches as a whole. So, the algorithm has <code>O(|S|)</code> time complexity.<br>
Obviously, it requires <code>O(|S|)</code> space to store Z-values.</p>
<h4>Search algorithm</h4>
<p>You could ask why we need these Z-values at all. This is an appropriate question :) We can use the idea of Z-values for doing a substring search.<br>
Take a string <code>T</code> (for “text”) and a string <code>P</code> (for “pattern”), both built of characters of some alphabet <code>A</code>. Also, take character <code>'$'</code> which is not in <code>A</code>. This character is called <strong>the sentinel</strong>. Assemble all these things in the following way: <code>P$T</code>.</p>
<p>Compute Z-values of this composite string by the advanced algorithm described earlier. All this values will be limited to <code>|P|</code> (except <code>Z<sub>0</sub></code>, of course) because of the sentinel which can’t be found at any place in <code>P</code> or <code>T</code>. And when you see a <code>Z<sub>j</sub> = |P|</code> then you can be sure that substring <code>T(j..j+|P|-1)</code> is an occurrence of <code>P</code> in <code>T</code>. And vice versa: you can be confident that all occurrences will be marked in the list of Z-values.</p>
<p class="small-margin-bottom">Let’s consider an example. <code>P = "ab"</code>, <code>T = "xaybzabxaby"</code>:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable">4</td>
<td class="ztable">5</td>
<td class="ztable">6</td>
<td class="ztable">7</td>
<td class="ztable ztable-zbox">8</td>
<td class="ztable ztable-zbox">9</td>
<td class="ztable">10</td>
<td class="ztable ztable-zbox">11</td>
<td class="ztable ztable-zbox">12</td>
<td class="ztable">13</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">b</td>
<td class="ztable">$</td>
<td class="ztable">x</td>
<td class="ztable">a</td>
<td class="ztable">y</td>
<td class="ztable">b</td>
<td class="ztable">z</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable">x</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">b</td>
<td class="ztable">y</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">14</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<p class="small-margin-bottom">Even with overlapping matches: <code>P = "aa"</code>, <code>T = "xaaay"</code>:</p>
<table class="ztable">
<tbody>
<tr>
<td class="ztable ztable-rowhead">Index</td>
<td class="ztable">0</td>
<td class="ztable">1</td>
<td class="ztable">2</td>
<td class="ztable">3</td>
<td class="ztable ztable-zbox">4</td>
<td class="ztable ztable-zbox">5</td>
<td class="ztable ztable-zbox">6</td>
<td class="ztable">7</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Character</td>
<td class="ztable">a</td>
<td class="ztable">a</td>
<td class="ztable">$</td>
<td class="ztable">x</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable ztable-zbox">a</td>
<td class="ztable">y</td>
</tr>
<tr>
<td class="ztable ztable-rowhead">Z-value</td>
<td class="ztable">8</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
<td class="ztable">0</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable ztable-zbox">2</td>
<td class="ztable">1</td>
<td class="ztable">0</td>
</tr>
</tbody>
</table>
<p>This search algorithm has the <code>O(|P|+|T|)</code> time and space complexity because it has the longest, dominating part – search of Z-values which is <code>O(|S|)</code>, <code>|S|=|P|+|T|</code>.</p>
<p>Good algorithm. But there is an obstacle for a general-purpose use: the choice of the sentinel. In some applications you have a short known alphabet. For example, in bioinformatics there are symbols <code>'A'</code>, <code>'C'</code>, <code>'G'</code> and <code>'T'</code> and we can simply use <code>'$'</code> as the sentinel. But what about general Unicode strings?</p>
<h4>Search algorithm without the sentinel</h4>
<p>Fortunately, there is search algorithm that doesn’t need to use sentinels. The idea is in calculating Z-values of a string <code>PT</code> with a simple modification: after each Z-value is calculated, limit it to the <code>|P|</code>, i.e., <code>Z<sub>k</sub> := min{|S|, Z<sub>k</sub>}</code>. This limitation plays role of the sentinel.</p>
<p>The Python code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-58657937b5896684127174" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def search_without_sentinel(pattern, text):
    """Search without the sentinel."""

    s = pattern + text
    Z = [0] * len(s)
    Z[0] = len(s)

    rt = 0
    lt = 0

    occurrence = []

    for k in range(1, len(s)):
        if k &gt; rt:
            n = 0
            while n + k &lt; len(s) and s[n] == s[n+k]:
                n += 1
            Z[k] = n
            if n &gt; 0:
                lt = k
                rt = k+n-1
        else:
            p = k - lt
            right_part_len = rt - k + 1

            if Z[p] &lt; right_part_len:
                Z[k] = Z[p]
            else:
                i = rt + 1
                while i &lt; len(s) and s[i] == s[i - k]:
                    i += 1
                Z[k] = i - k

                lt = k
                rt = i - 1

        Z[k] = min(len(pattern), Z[k])

        # An occurence found.
        if Z[k] == len(pattern):
            occurrence.append(k - len(pattern))

    return occurrence</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-58657937b5896684127174-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-2">2</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-4">4</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-6">6</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-8">8</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-10">10</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-12">12</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-14">14</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-16">16</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-18">18</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-20">20</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-22">22</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-24">24</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-26">26</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-28">28</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-30">30</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-32">32</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-34">34</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-36">36</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-38">38</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-40">40</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-58657937b5896684127174-42">42</div><div class="crayon-num" data-line="crayon-58657937b5896684127174-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-58657937b5896684127174-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">search_without_sentinel</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"""Search without the sentinel."""</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pattern</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-10">&nbsp;</div><div class="crayon-line" id="crayon-58657937b5896684127174-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">occurrence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-12">&nbsp;</div><div class="crayon-line" id="crayon-58657937b5896684127174-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">n</span><span class="crayon-o">+</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-o">+</span><span class="crayon-v">n</span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">lt</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-24"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">right_part_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">right_part_len</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">k</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-36">&nbsp;</div><div class="crayon-line" id="crayon-58657937b5896684127174-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">min</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-38">&nbsp;</div><div class="crayon-line" id="crayon-58657937b5896684127174-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># An occurence found.</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">Z</span><span class="crayon-sy">[</span><span class="crayon-v">k</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-58657937b5896684127174-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">occurrence</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">pattern</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-58657937b5896684127174-42">&nbsp;</div><div class="crayon-line" id="crayon-58657937b5896684127174-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">occurrence</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0095 seconds] -->
<p>&nbsp;</p>
<p>All the code can be found <a href="https://github.com/ivanyu/string-algorithms/blob/master/z_algorithm.py">here</a>.</p>
<p>Thank you.</p>
<!-- AddThis Sharing Buttons below --><div class="at-below-post addthis_default_style addthis_toolbox " data-title="Z algorithm" data-url="https://ivanyu.me/blog/2013/10/15/z-algorithm/"><div class="atclear"></div><div id="atstbx" class="at-share-tbx-element at-share-tbx-native addthis_default_style addthis_20x20_style addthis-smartlayers addthis-animated at4-show"><a class="addthis_button_tweet at_native_button at300b"><div class="tweet_iframe_widget" style="width: 62px; height: 25px;"><span><iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" title="Twitter Tweet Button" src="./Z algorithm _ Ivan Yurchenko_files/tweet_button.3748f7cda49448f6c6f7854238570ba0.en.html" style="position: static; visibility: visible; width: 60px; height: 20px;" data-url="https://ivanyu.me/blog/2013/10/15/z-algorithm/"></iframe></span></div></a><a class="addthis_button_facebook_like at_native_button at300b" fb:like:layout="button_count"><div class="fb-like fb_iframe_widget" data-layout="button_count" data-show_faces="false" data-share="true" data-action="like" data-width="90" data-height="25" data-font="arial" data-href="https://ivanyu.me/blog/2013/10/15/z-algorithm/" data-send="false" style="height: 25px;" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=172525162793917&amp;container_width=0&amp;font=arial&amp;height=25&amp;href=https%3A%2F%2Fivanyu.me%2Fblog%2F2013%2F10%2F15%2Fz-algorithm%2F&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;share=true&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 104px; height: 20px;"><iframe name="f399f8add2da3ec" width="90px" height="25px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./Z algorithm _ Ivan Yurchenko_files/like.html" style="border: none; visibility: visible; width: 104px; height: 20px;" class=""></iframe></span></div></a><a class="addthis_button_facebook_share at_native_button at300b" fb:share:layout="button_count"><div class="fb-share-button fb_iframe_widget" data-layout="button_count" data-href="https://ivanyu.me/blog/2013/10/15/z-algorithm/" style="height: 25px;" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=172525162793917&amp;container_width=0&amp;href=https%3A%2F%2Fivanyu.me%2Fblog%2F2013%2F10%2F15%2Fz-algorithm%2F&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey"><span style="vertical-align: bottom; width: 68px; height: 20px;"><iframe name="f22062446c32c34" width="1000px" height="1000px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:share_button Facebook Social Plugin" src="./Z algorithm _ Ivan Yurchenko_files/share_button.html" style="border: none; visibility: visible; width: 68px; height: 20px;" class=""></iframe></span></div></a><a class="addthis_button_google_plusone at_native_button at300b" g:plusone:size="medium"><div class="google_plusone_iframe_widget" style="width: 90px; height: 25px;"><span><div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 90px; height: 20px;"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 90px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" width="100%" id="I0_1483084116282" name="I0_1483084116282" src="./Z algorithm _ Ivan Yurchenko_files/fastbutton.html" data-gapiattached="true" title="+1"></iframe></div></span></div></a><a class="addthis_button_linkedin_counter at_native_button at300b"><div class="linkedin_counter_iframe_widget" style="width: 100px; height: 25px;"><span><iframe title="AddThis | LinkedIn Button" frameborder="0" role="presentation" scrolling="no" allowtransparency="true" scrollbars="no" style="width:100px; height:25px;" src="./Z algorithm _ Ivan Yurchenko_files/linkedin.html"></iframe></span></div></a><a class="addthis_button_pinterest_pinit at300b" pi:pinit:layout="horizontal" pi:pinit:url="https://ivanyu.me/blog/2013/10/15/z-algorithm/"><div class="pin_it_iframe_widget" style="height: 25px;"><span><span class="at_PinItButton"></span></span></div></a><a class="addthis_counter addthis_pill_style at_native_button addthis_nonzero" href="https://ivanyu.me/blog/2013/10/15/z-algorithm/#" style="display: inline-block;"><a class="atc_s addthis_button_compact">Share<span></span></a><a class="addthis_button_expanded" target="_blank" title="More" href="https://ivanyu.me/blog/2013/10/15/z-algorithm/#">10</a></a><div class="atclear"></div></div></div><!-- AddThis Recommended Content below --> <div class="at-below-post-recommended addthis_default_style addthis_toolbox at-wordpress-hide"><div class="atclear"></div></div></div>
			</div><!-- .entry-content -->

	
	<footer class="entry-meta">
					<div>
				<span class="genericon genericon-month"></span><span class="posted-on">Posted on <a href="https://ivanyu.me/blog/2013/10/15/z-algorithm/" rel="bookmark"><time class="entry-date published" datetime="2013-10-15T20:35:40+00:00">October 15, 2013</time><time class="updated" datetime="2016-01-10T00:45:18+00:00">January 10, 2016</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://ivanyu.me/blog/author/ivanyu/">ivanyu</a></span></span>			</div>
							<div>
				<span class="comments-link"><span class="genericon genericon-comment"></span><a href="https://ivanyu.me/blog/2013/10/15/z-algorithm/#disqus_thread" data-disqus-identifier="5 http://ivanyu.me/?p=5">19 Comments</a></span>
			</div>
										<div class="cat-links">
				<span class="genericon genericon-category"></span>Posted in <a href="https://ivanyu.me/blog/category/algorithms/" rel="category tag">Algorithms</a>, <a href="https://ivanyu.me/blog/category/programming/" rel="category tag">Programming</a>			</div>
			
						<div class="tags-links">
				<span class="genericon genericon-tag"></span>Tagged <a href="https://ivanyu.me/blog/tag/algorithms-2/" rel="tag">algorithms</a>, <a href="https://ivanyu.me/blog/tag/strings/" rel="tag">strings</a>			</div>
					
			</footer><!-- .entry-meta --></article><!-- #post-## -->

				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">

			<div class="nav-previous"></div>
			<div class="nav-next"><a href="https://ivanyu.me/blog/2013/11/24/finding-a-cycle-in-a-linked-list/" rel="next">Finding a cycle in a linked list <span class="meta-nav genericon genericon-next"></span></a></div>

		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
<div id="disqus_thread"><iframe id="dsq-app1" name="dsq-app1" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Z algorithm _ Ivan Yurchenko_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 3150px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>

<script type="text/javascript">
var disqus_url = 'https://ivanyu.me/blog/2013/10/15/z-algorithm/';
var disqus_identifier = '5 http://ivanyu.me/?p=5';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'ivanyurchenko';
var disqus_title = "Z algorithm";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    
    
    this.language = '';
        this.callbacks.onReady.push(function () {

        // sync comments in the background so we don't block the page
        var script = document.createElement('script');
        script.async = true;
        script.src = '?cf_action=sync_comments&post_id=5';

        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
    });
    
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>


		
		</main><!-- #main -->
	</div><!-- #primary -->

	<div id="secondary" class="widget-area" role="complementary">
				<aside id="text-2" class="widget widget_text"><h3 class="widget-title">Author</h3>			<div class="textwidget"><p style="text-align: center;"><a href="https://ivanyu.me/about/"><img src="./Z algorithm _ Ivan Yurchenko_files/photo_circle_1.png" width="180" height="180" alt="Ivan Yurchenko"></a><br><a href="https://ivanyu.me/about/">Read about</a></p></div>
		</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="https://ivanyu.me/blog/2016/12/12/about-akka-streams/">About Akka Streams</a>
						</li>
					<li>
				<a href="https://ivanyu.me/blog/2016/03/28/time-based-version-1-uuids-ordering-in-postgresql/">Time-based (version 1) UUIDs ordering in PostgreSQL</a>
						</li>
					<li>
				<a href="https://ivanyu.me/blog/2016/01/11/type-safe-query-builders-in-scala-revisited-shapeless/">Type-safe query builders in Scala revisited: shapeless</a>
						</li>
					<li>
				<a href="https://ivanyu.me/blog/2015/10/25/retrospective-time-based-uuid-generation-with-spark/">Retrospective time-based UUID generation (with Spark)</a>
						</li>
					<li>
				<a href="https://ivanyu.me/blog/2015/10/18/type-safe-query-builders-in-scala/">Type-safe query builders in Scala</a>
						</li>
				</ul>
		</aside>		<aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Peng Zhang</span> on <a href="https://ivanyu.me/blog/2016/12/12/about-akka-streams/#comment-53">About Akka Streams</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://ivanyu.me/blog/2016/12/12/about-akka-streams/" rel="external nofollow" class="url">About Akka Streams | Ivan Yurchenko</a></span> on <a href="https://ivanyu.me/blog/2015/01/27/introduction-to-akka/#comment-52">Introduction to Akka</a></li><li class="recentcomments"><span class="comment-author-link"><a href="http://sanchopancho.ru/" rel="external nofollow" class="url">Ivan Yurchenko | Yet another programming blog.</a></span> on <a href="https://ivanyu.me/blog/2016/03/28/time-based-version-1-uuids-ordering-in-postgresql/#comment-50">Time-based (version 1) UUIDs ordering in PostgreSQL</a></li><li class="recentcomments"><span class="comment-author-link">gaurav kumar</span> on <a href="https://ivanyu.me/blog/2013/10/15/z-algorithm/#comment-49">Z algorithm</a></li><li class="recentcomments"><span class="comment-author-link">王晓胜</span> on <a href="https://ivanyu.me/blog/2015/02/16/delayed-message-delivery-in-rabbitmq/#comment-48">Delayed message delivery in RabbitMQ</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href="https://ivanyu.me/blog/2016/12/">December 2016</a></li>
	<li><a href="https://ivanyu.me/blog/2016/03/">March 2016</a></li>
	<li><a href="https://ivanyu.me/blog/2016/01/">January 2016</a></li>
	<li><a href="https://ivanyu.me/blog/2015/10/">October 2015</a></li>
	<li><a href="https://ivanyu.me/blog/2015/06/">June 2015</a></li>
	<li><a href="https://ivanyu.me/blog/2015/05/">May 2015</a></li>
	<li><a href="https://ivanyu.me/blog/2015/04/">April 2015</a></li>
	<li><a href="https://ivanyu.me/blog/2015/03/">March 2015</a></li>
	<li><a href="https://ivanyu.me/blog/2015/02/">February 2015</a></li>
	<li><a href="https://ivanyu.me/blog/2015/01/">January 2015</a></li>
	<li><a href="https://ivanyu.me/blog/2014/12/">December 2014</a></li>
	<li><a href="https://ivanyu.me/blog/2014/11/">November 2014</a></li>
	<li><a href="https://ivanyu.me/blog/2014/09/">September 2014</a></li>
	<li><a href="https://ivanyu.me/blog/2013/12/">December 2013</a></li>
	<li><a href="https://ivanyu.me/blog/2013/11/">November 2013</a></li>
	<li><a href="https://ivanyu.me/blog/2013/10/">October 2013</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-2"><a href="https://ivanyu.me/blog/category/algorithms/">Algorithms</a>
</li>
	<li class="cat-item cat-item-17"><a href="https://ivanyu.me/blog/category/linkblog/">Linkblog</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://ivanyu.me/blog/category/programming/">Programming</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://ivanyu.me/blog/category/unix/">Unix</a>
</li>
		</ul>
</aside><aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://ivanyu.me/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search …" value="" name="s">
	</label>
	<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="meta-2" class="widget widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="https://ivanyu.me/wp-login.php">Log in</a></li>
			<li><a href="https://ivanyu.me/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://ivanyu.me/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</aside>	</div><!-- #secondary -->

		</div><!-- #content -->
	</div><!-- #page -->

		<div class="footer-wrap">
		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info">
				<p>
  <span style="float: left; font-size: 80%; line-height: 1.2em;">
    <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="./Z algorithm _ Ivan Yurchenko_files/88x31.png"></a><br>
    Except where otherwise noted, content on this site is licensed under a<br><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </span>
<span>
<a href="https://wordpress.org/" rel="generator" class="genericon genericon-wordpress" title="Proudly Powered by WordPress"></a> Theme: Kirumo by <a href="http://johnregan3.com/" rel="designer">johnregan3</a>.</span></p>
			</div><!-- .site-info -->
			<nav id="footer-navigation" class="social-menu" role="navigation">
				<div class="menu"><ul>
<li><a href="https://ivanyu.me/">Home</a></li><li class="menu-item-13"></li>
</ul></div>
			</nav></footer></div>
			
		<!-- #colophon -->
	</div>
	</div><!-- #page-wrap -->
<!-- #page-clip -->
        <script type="text/javascript">
        // <![CDATA[
        var disqus_shortname = 'ivanyurchenko';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1 && nodes[i].parentNode.tagName == 'A') {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        // ]]>
        </script>
        <!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter22645558 = new Ya.Metrika({id:22645558,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    ut:"noindex"});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript>&lt;div&gt;&lt;img src="//mc.yandex.ru/watch/22645558?ut=noindex" style="position:absolute; left:-9999px;" alt="" /&gt;&lt;/div&gt;</noscript>
<!-- /Yandex.Metrika counter --><script data-cfasync="false" type="text/javascript"></script>
                <!-- AddThis Settings Begin -->
                <script data-cfasync="false" type="text/javascript">
                    var addthis_product = "wpp-5.3.4";
                    var wp_product_version = "wpp-5.3.4";
                    var wp_blog_version = "4.7";
                    var addthis_plugin_info = {"info_status":"enabled","cms_name":"WordPress","plugin_name":"Share Buttons by AddThis","plugin_version":"5.3.4","anonymous_profile_id":"wp-ce461c793be6f961e0e06c4af9f9dec8","plugin_mode":"AddThis","select_prefs":{"addthis_per_post_enabled":true,"addthis_above_enabled":false,"addthis_below_enabled":true,"addthis_sidebar_enabled":false,"addthis_mobile_toolbar_enabled":false,"addthis_above_showon_home":false,"addthis_below_showon_home":false,"addthis_above_showon_pages":false,"addthis_below_showon_pages":false,"addthis_above_showon_categories":false,"addthis_below_showon_categories":false,"addthis_above_showon_archives":false,"addthis_below_showon_archives":false,"addthis_above_showon_posts":true,"addthis_above_showon_excerpts":true,"addthis_below_showon_posts":true,"addthis_below_showon_excerpts":true,"addthis_sidebar_showon_home":true,"addthis_sidebar_showon_posts":true,"addthis_sidebar_showon_pages":true,"addthis_sidebar_showon_archives":true,"addthis_sidebar_showon_categories":true,"addthis_mobile_toolbar_showon_home":true,"addthis_mobile_toolbar_showon_posts":true,"addthis_mobile_toolbar_showon_pages":true,"addthis_mobile_toolbar_showon_archives":true,"addthis_mobile_toolbar_showon_categories":true,"sharing_enabled_on_post_via_metabox":true},"page_info":{"template":"posts","post_type":""}};
                    if (typeof(addthis_config) == "undefined") {
                        var addthis_config = {"data_track_clickback":false,"ui_atversion":300};
                    }
                    if (typeof(addthis_share) == "undefined") {
                        var addthis_share = {};
                    }
                    if (typeof(addthis_layers) == "undefined") {
                        var addthis_layers = {};
                    }
                </script>
                <script data-cfasync="false" type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/addthis_widget.js.download">
                </script><iframe style="display: none;" src="./Z algorithm _ Ivan Yurchenko_files/saved_resource(2).html"></iframe><div id="_atssh" style="visibility: hidden; height: 1px; width: 1px; position: absolute; top: -9999px; z-index: 100000;"><iframe id="_atssh858" title="AddThis utility frame" src="./Z algorithm _ Ivan Yurchenko_files/sh.54c6626dbe9f22c083627c06.html" style="height: 1px; width: 1px; position: absolute; top: 0px; z-index: 100000; border: 0px; left: 0px;"></iframe></div><style id="service-icons-0"></style>
                <script data-cfasync="false" type="text/javascript">
                    (function() {
                        var at_interval = setInterval(function () {
                            if(window.addthis) {
                                clearInterval(at_interval);
                                addthis.layers(addthis_layers);
                            }
                        },1000)
                    }());
                </script>
                <link rel="stylesheet" id="addthis_output-css" href="./Z algorithm _ Ivan Yurchenko_files/output.css" type="text/css" media="all">
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/skip-link-focus-fix.js.download"></script>
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/kirumo.js.download"></script>
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/comment-reply.min.js.download"></script>
<script type="text/javascript" src="./Z algorithm _ Ivan Yurchenko_files/wp-embed.min.js.download"></script>
<!--wp_footer-->


<div id="fb-root" class=" fb_reset"><script src="./Z algorithm _ Ivan Yurchenko_files/sdk.js.download" async=""></script><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Z algorithm _ Ivan Yurchenko_files/iPrOY23SGAp.html" style="border: none;"></iframe></div></div></div><iframe name="oauth2relay345780302" id="oauth2relay345780302" src="./Z algorithm _ Ivan Yurchenko_files/postmessageRelay.html" tabindex="-1" aria-hidden="true" style="width: 1px; height: 1px; position: absolute; top: -100px;"></iframe><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./Z algorithm _ Ivan Yurchenko_files/saved_resource(3).html"></iframe></body></html>