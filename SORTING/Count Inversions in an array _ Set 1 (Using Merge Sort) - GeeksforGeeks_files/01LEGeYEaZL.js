define("MediaLoader",["ImageBuilder",document,window],function(m,k,n){var l=function(g,e){var f="";k.defaultView&&k.defaultView.getComputedStyle?f=k.defaultView.getComputedStyle(g,"").getPropertyValue(e):g.currentStyle&&(e=e.replace(/\-(\w)/g,function(e,b){return b.toUpperCase()}),f=g.currentStyle[e]);return f};return{load:function(g){for(var e=0,f=0;f<g.length;f++){var h=g[f],b=h.clientWidth,a=h.clientHeight;if(0!=b||0!=a){var d=l(h,"padding-left"),d=d.replace("px",""),b=b-2*d,a=a-2*d,k=h.getAttribute("data-baseUrl"),
c=h.getAttribute("data-background"),b=(new m(k)).autoCrop().scaleToRectangle(b,a).border(d,255,255,255);if("transparent"===c){a=l(window.container,"background-color");d=a.match(/rgba?\(([\d\s]+,[\d\s]+,[\d\s]+(,.*)?)\)/);c=null;if(d&&1<d.length)for(c=d[1].split(","),a=0;3>a;++a)c[a]=Number(c[a]);else if("#"!==a.charAt(0)||7!==a.length||isNaN("0x"+a.slice(1))){if("#"!==a.charAt(0)||4!==a.length||isNaN("0x"+a.slice(1)))throw Error("Fail to parse: "+a);c=[parseInt(a.slice(1,2)+a.slice(1,2),16),parseInt(a.slice(2,
3)+a.slice(2,3),16),parseInt(a.slice(3,4)+a.slice(3,4),16)]}else c=[parseInt(a.slice(1,3),16),parseInt(a.slice(3,5),16),parseInt(a.slice(5,7),16)];b=b.background(c[0],c[1],c[2])}b=b.preloadAndBuild();h.style.backgroundImage="url("+b+")";e++}}if(0===e)throw Error("ml:no-items-rendered");},type:"MediaLoader"}});